<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment>
  <ser:coreEntry isProxy="true" isEnabled="true" xmlns:ser="http://www.bea.com/wli/sb/services">
    <ser:description>Proxy responsável por prover informações do cliente claro</ser:description><ser:binding type="SOAP" isSoap12="true" xsi:type="con:SoapBindingType" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:wsdl ref="relacionar/cliente/clienteclaro/wsdl/proxy/ClienteClaroWSDLV1_0"/><con:port><con:name>ClienteClaroPort12</con:name><con:namespace>http://www.netservicos.com.br/ClienteClaro</con:namespace></con:port><con:selector type="SOAP body"><con:mapping operation="listar" value=""/></con:selector></ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig xmlns:ser="http://www.bea.com/wli/sb/services">
    <tran:provider-id xmlns:tran="http://www.bea.com/wli/sb/transports">http</tran:provider-id>
    <tran:inbound xmlns:tran="http://www.bea.com/wli/sb/transports">true</tran:inbound>
    <tran:URI xmlns:tran="http://www.bea.com/wli/sb/transports">
      <env:value xmlns:env="http://www.bea.com/wli/config/env">/relacionar/cliente/clienteclaro/ClienteClaro12V1</env:value>
    </tran:URI>
    <tran:inbound-properties xmlns:tran="http://www.bea.com/wli/sb/transports"/>
    <tran:all-headers xmlns:tran="http://www.bea.com/wli/sb/transports">false</tran:all-headers>
    <tran:provider-specific xmlns:tran="http://www.bea.com/wli/sb/transports"><http:inbound-properties xmlns:http="http://www.bea.com/wli/sb/transports/http"><http:client-authentication xsi:type="http:HttpBasicAuthenticationType" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></http:inbound-properties></tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fb1" xmlns:ser="http://www.bea.com/wli/sb/services">
    
    
    
    <con:pipeline type="request" name="Operacao Listar_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Log Request"><con:comment>Estagio para logar header e body da requisicao</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fda</con2:id><con1:logLevel>debug</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText></con1:expr><con1:message>Request de entrada</con1:message></con1:log></con:actions></con:stage><con:stage name="Tratar Header">
        <con:comment>Estagio que realiza o tratamento do NetHeader.</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/v2/NetHeader" prefix="netheader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          
          <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4427118606758265766-6e7ee285.14dab34788b.-7ff6</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/TransformarNetHeaderDefaults"/>
                <con2:param name="tokenDefault">
                  <con2:path>fn-bea:uuid()</con2:path>
                </con2:param>
                <con2:param name="netHeaderIN">
                  <con2:path>$header//netheader:NetHeader</con2:path>
                </con2:param>
                <con2:param name="numeroProtocoloDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="aplicacaoDefault">
                  <con2:path>'OTHER'</con2:path>
                </con2:param>
                <con2:param name="funcionalidadeDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="versaoServicoDefault">
                  <con2:path>'1.0'</con2:path>
                </con2:param>
                <con2:param name="usernameDefault">
                  <con2:path>'ANONYMOUS'</con2:path>
                </con2:param>
                <con2:param name="numeroChamadaDefault">
                  <con2:path>''</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
        <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4427118606758265766-6e7ee285.14dab34788b.-7ff7</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText></con1:expr>
            <con1:message>Header de entrada</con1:message>
          </con1:log></con:actions>
      </con:stage>
      <con:stage name="Validar Request de entrada" errorHandler="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fd7"><con:comment>Estagio responsavel por validar o request de entrada</con:comment><con:context><con1:varNsDecl namespace="http://www.netservicos.com.br/ClienteClaro" prefix="cli" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:validate xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd8</con2:id><con1:wsdl ref="relacionar/cliente/clienteclaro/wsdl/proxy/ClienteClaroWSDLV1_0"/><con1:schemaElement xmlns:cli="http://www.netservicos.com.br/ClienteClaro">cli:parametrosListar</con1:schemaElement><con1:varName>body</con1:varName><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./cli:parametrosListar</con2:xpathText></con1:location></con1:validate></con:actions></con:stage><con:stage name="Validacao de Campos obrigatórios" errorHandler="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fcd">
        <con:comment>Estágios responsável por validar os campos obrigatórios do request</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/ClienteClaro" prefix="cli" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/cliente" prefix="cli1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/paginacao" prefix="pag" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4427118606758265766-6e7ee285.14dab34788b.-7ff5</con2:id>
            <con1:case>
              <con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:cpf) eq ''
</con2:xqueryText></con1:condition>
              <con1:actions>
                <con1:assign varName="campo">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4427118606758265766-6e7ee285.14dab34788b.-7ff3</con2:id>
                  <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'CPF'</con2:xqueryText></con1:expr>
                </con1:assign>
              </con1:actions>
            </con1:case>
            <con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:cnpj) eq ''
</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="campo"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd1</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'CNPJ'</con2:xqueryText></con1:expr></con1:assign></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:mobileBan) eq ''
</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="campo"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd0</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'mobileBan'</con2:xqueryText></con1:expr></con1:assign></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:MSISDN) eq ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="campo"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-8000</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'MSISDN'</con2:xqueryText></con1:expr></con1:assign></con1:actions></con1:case><con1:default/>
          </con1:ifThenElse>
        <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2891690681958490031--483f1441.14ea7207b07.-7f8b</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:cpf) ne '' or
fn:data($body/cli:parametrosListar/cli:cnpj) ne '' or
fn:data($body/cli:parametrosListar/cli:mobileBan) ne ''</con2:xqueryText></con1:condition><con1:actions><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fec</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:not(fn:exists($body/cli:parametrosListar/cli:paginacao/cli:numeroPaginaAtual/node())) or
fn:data($body/cli:parametrosListar/cli:paginacao/cli:numeroPaginaAtual) eq ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="campo"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7feb</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:concat($campo,', numeroPaginaAtual')</con2:xqueryText></con1:expr></con1:assign></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fea</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:not(fn:exists($body/cli:parametrosListar/cli:paginacao/cli:quantidadeTotalPagina/node())) or
fn:data($body/cli:parametrosListar/cli:paginacao/cli:quantidadeTotalPagina) eq ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="campo"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fe9</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:concat($campo,', quantidadeTotalPagina ')</con2:xqueryText></con1:expr></con1:assign></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fe8</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($campo) ne ''</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fe7</con2:id><con1:errCode>ESB-CLIEN-0001</con1:errCode><con1:message>Campo {0} é obrigatório.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse></con:actions>
      </con:stage>
      
      
      
      <con:stage name="Lista dados assinantes ou calculo de multa" errorHandler="_onErrorHandler-2891690681958490031--483f1441.14ea7207b07.-7ffe"><con:comment>Estágio responsável por validar quais servicos Claro serão orquestrados</con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/v2/NetHeader" prefix="netheader" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.claro.com.br/EBO/Claro/v1" prefix="v11" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.claro.com.br/EBS/Claro/v2" prefix="v2" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.claro.com.br/EBS/Claro/v1" prefix="v1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:varNsDecl namespace="http://www.netservicos.com.br/ClienteClaro" prefix="cli" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fff</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($body/cli:parametrosListar/cli:cpf) ne '' or
fn:data($body/cli:parametrosListar/cli:cnpj) ne '' or
fn:data($body/cli:parametrosListar/cli:mobileBan) ne ''</con2:xqueryText></con1:condition><con1:actions><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fc1</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="relacionar/cliente/clienteclaro/businessservice/ListarAssinantesBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>listarAssinantes</con1:operation><con1:request><con1:body>$listarAssinantesRequest</con1:body></con1:request><con1:response><con1:body>listarAssinantesResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="businessService"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7ffe</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'ListarAssinantesBSV1_0'</con2:xqueryText></con1:expr></con1:assign><con1:assign varName="listarAssinantesRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fc0</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="relacionar/cliente/clienteclaro/transformation/xquery/TransformarListarAssinantesRequestXQuery"/><con2:param name="parametrosListar1"><con2:path>$body/cli:parametrosListar</con2:path></con2:param><con2:param name="netHeader1"><con2:path>$header//netheader:NetHeader</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fbf</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$listarAssinantesRequest</con3:xqueryText></con2:expr><con2:message>listarAssinantesRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fbe</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$listarAssinantesResponse</con3:xqueryText></con2:expr><con2:message>listarAssinantesResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5084198155296691989--42410a18.14e462ec6e4.-7ff9</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($listarAssinantesResponse/soap12-env:Detail/node())), 'TechnicalFault')
or 
fn:contains(xs:string(fn:name($listarAssinantesResponse/soap12-env:Detail/node())), 'ParametroInvalidoFault')</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="exceptionStackTrace"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5084198155296691989--42410a18.14e462ec6e4.-7ffb</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$listarAssinantesResponse/soap12-env:Detail/node()
</con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5084198155296691989--42410a18.14e462ec6e4.-7ffa</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$exceptionStackTrace</con3:xqueryText></con2:expr><con2:message>exceptionStackTrace</con2:message></con2:log><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5084198155296691989--42410a18.14e462ec6e4.-7ff7</con2:id><con1:errCode>ESB-CLIEN-0019</con1:errCode><con1:message>Erro durante a execução do recurso: {0}.</con1:message></con1:Error></con1:actions></con1:case><con1:default><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb8</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:exists($listarAssinantesResponse/v1:assinantes/v11:assinante/node()) or
fn:data($listarAssinantesResponse/v1:assinantes/v11:assinante) ne ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="assinanteList"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb5</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cli:resultadoListar>
	&lt;cli:assinantes/>
    &lt;cli:paginacao/>
&lt;/cli:resultadoListar></con2:xqueryText></con1:expr></con1:assign><con1:foreach>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4856682456546712259-7fddfd08.14dbf86673a.-7fff</con2:id>
            <con1:variable>listarAssinantesResponse</con1:variable>
            <con1:expression><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./v1:assinantes/v11:assinante</con2:xpathText></con1:expression>
            <con1:value-variable>assinante</con1:value-variable>
            <con1:index-variable>indexAssinante</con1:index-variable>
            <con1:total-variable>countAssinante</con1:total-variable>
            <con1:actions>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4856682456546712259-7fddfd08.14dbf86673a.-7ffe</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$assinante</con3:xqueryText></con2:expr><con2:message>assinante</con2:message>
              </con2:log>
            <con1:assign varName="situacao"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-8000</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($assinante/v11:situacao)</con2:xqueryText></con1:expr></con1:assign><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fff</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case($situacao) eq 'ATIVO'</con2:xqueryText></con1:condition><con1:actions><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fcb</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$situacao</con3:xqueryText></con2:expr><con2:message>Situacao da assinatura</con2:message></con2:log><con1:assign varName="tipoPessoa"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7fff</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($assinante/v11:contrato/v11:cliente/v11:tipo-pessoa)</con2:xqueryText></con1:expr></con1:assign><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case($tipoPessoa) eq 'PF'</con2:xqueryText></con1:condition><con1:actions><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fca</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$tipoPessoa</con3:xqueryText></con2:expr><con2:message>Assinante Pessoa Fisica</con2:message></con2:log><con1:assign varName="tipoAssinatura"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ff9</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($assinante/v11:tipo-assinatura)</con2:xqueryText></con1:expr></con1:assign><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ffb</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case($tipoAssinatura) eq 'CLARO_CARTAO'</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="crmClienteId"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb3</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($assinante/v11:contrato/v11:cliente/v11:crm-cliente-id)</con2:xqueryText></con1:expr></con1:assign><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-8000</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="relacionar/cliente/clienteclaro/businessservice/ConsultarDadosCadastraisClienteBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>consultarDadosCadastraisCliente</con1:operation><con1:request><con1:body>$consultarDadosCadastraisClienteRequest</con1:body></con1:request><con1:response><con1:body>consultarDadosCadastraisClienteResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="businessService"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5741601606535480737-1504c851.14ddf4ebc28.-7fff</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'ConsultarDadosCadastraisClienteBSV1_0'</con2:xqueryText></con1:expr></con1:assign><con1:assign varName="consultarDadosCadastraisClienteRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ff1</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="relacionar/cliente/clienteclaro/transformation/xquery/TransformarConsultarDadosCadastraisClienteRequestXQuery"/><con2:param name="crmClienteId1"><con2:path>$crmClienteId</con2:path></con2:param><con2:param name="netHeader1"><con2:path>$header//netheader:NetHeader</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ff0</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarDadosCadastraisClienteRequest</con3:xqueryText></con2:expr><con2:message>consultarDadosCadastraisClienteRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7fef</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarDadosCadastraisClienteResponse</con3:xqueryText></con2:expr><con2:message>consultarDadosCadastraisClienteResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ffc</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$consultarDadosCadastraisClienteResponse/soap12-env:Detail/node() ne ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="exceptionStackTrace"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ff9</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$consultarDadosCadastraisClienteResponse/soap12-env:Detail/node()</con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ff6</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$exceptionStackTrace</con3:xqueryText></con2:expr><con2:message>exceptionStackTrace</con2:message></con2:log><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ff8</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($consultarDadosCadastraisClienteResponse/soap12-env:Detail/node())), 'TechnicalFault')
or 
fn:contains(xs:string(fn:name($consultarDadosCadastraisClienteResponse/soap12-env:Detail/node())), 'ParametroInvalidoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ff5</con2:id><con1:errCode>ESB-CLIEN-0019</con1:errCode><con1:message>Erro durante a execução do recurso: {0}.</con1:message></con1:Error></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($consultarDadosCadastraisClienteResponse/soap12-env:Detail/node())), 'ClienteNaoEncontradoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7ff0</con2:id><con1:errCode>ESB-CLIEN-0041</con1:errCode><con1:message>Cliente Claro não encontrado.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:assign varName="assinante"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb4</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<cli:assinante>
	<cli:dadosCadastrais>
    	{
    		if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:data-nascimento) ne '')then
				<cli:dataNascimento>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:data-nascimento)}</cli:dataNascimento>    			
    		else()
    	}
    	{
    		if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nacionalidade) ne '')then
    			<cli:nacionalidade>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nacionalidade)}</cli:nacionalidade>
    		else()
    	}    	
    	{
    		if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nome-mae) ne '')then
    			<cli:nomeMae>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nome-mae)}</cli:nomeMae>
    		else()
    	} 
    	{
    		if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg) ne '')then
    			<cli:RG>
    				{
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:numero) ne '')then
    			    		<cli:numero>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:numero)}</cli:numero>
    					else()
    				}
    				{
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:orgao-emissor) ne '')then
							<cli:orgaoExpedidor>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:orgao-emissor)}</cli:orgaoExpedidor>
    					else()
    				}
     				{
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:data-emissao) ne '')then
							<cli:dataExpedicao>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:data-emissao)}</cli:dataExpedicao>
    					else()
    				}      				
    			</cli:RG>
    		else()
		}
		{
			if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne) ne '')then
		    	<cli:RNE>
		    	    {
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:numero) ne '')then
		  	  				<cli:numero>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:numero)}</cli:numero>
    					else()
    				} 
		    	    {
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:orgao-emissor) ne '')then
		      				<cli:orgaoEmissor>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:orgao-emissor)}</cli:orgaoEmissor>
    					else()
    				} 
		    	    {
    					if (data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:data-emissao) ne '')then
							<cli:dataExpedicao>{data($consultarDadosCadastraisClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:data-emissao)}</cli:dataExpedicao>
    					else()
    				} 
    			</cli:RNE>
    		else()
    	}
    	{
    		if (data($assinante/v11:titularidade-assinante/v11:indicador-titular) ne '' or data($assinante/v11:aparelho/v11:msisdn) ne '')then
    			<cli:telefones>
    				<cli:telefone>
            			{
    						if (data($assinante/v11:titularidade-assinante/v11:indicador-titular) ne '')then
		        				<cli:indicadorTitularidade>{data($assinante/v11:titularidade-assinante/v11:indicador-titular)}</cli:indicadorTitularidade>
    						else(
	    						<cli:indicadorTitularidade>{data('true')}</cli:indicadorTitularidade>
    						)
    					}
    					{
    						if (data($assinante/v11:aparelho/v11:msisdn) ne '')then
		        				<cli:MSISDN>{data($assinante/v11:aparelho/v11:msisdn)}</cli:MSISDN>
    						else()
    					} 
        			</cli:telefone>
   				</cli:telefones>
   			else()
   		}
		{
    		if (data($assinante/v11:tipo-assinatura) ne '')then
		  		<cli:tipoAssinatura>{data($assinante/v11:tipo-assinatura)}</cli:tipoAssinatura>
    		else()
    	}
    	{
    		if (data($assinante/v11:tipo-servico) ne '')then
		  		<cli:tipoServico>{data($assinante/v11:tipo-servico)}</cli:tipoServico>
    		else()
    	}  
	</cli:dadosCadastrais>
</cli:assinante>]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7fee</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$assinante</con3:xqueryText></con2:expr><con2:message>assinante</con2:message></con2:log></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:upper-case($tipoAssinatura) eq 'CLARO_CONTA' 
or 
fn:upper-case($tipoAssinatura) eq 'CLARO_CONTROLE'</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="mobileAssinanteId"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb2</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($assinante/v11:mobile-assinante-id)</con2:xqueryText></con1:expr></con1:assign><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ff6</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="relacionar/cliente/clienteclaro/businessservice/ConsultarDadosFaturamentoClienteBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>consultarDadosFaturamentoCliente</con1:operation><con1:request><con1:body>$consultarDadosFaturamentoClienteRequest</con1:body></con1:request><con1:response><con1:body>consultarDadosFaturamentoClienteResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="businessService"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5741601606535480737-1504c851.14ddf4ebc28.-7ffe</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'ConsultarDadosFaturamentoClienteBSV1_0'</con2:xqueryText></con1:expr></con1:assign><con1:assign varName="consultarDadosFaturamentoClienteRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7fee</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="relacionar/cliente/clienteclaro/transformation/xquery/TransformarConsultarDadosFaturamentoClienteRequestXQuery"/><con2:param name="mobileAssinanteId1"><con2:path>$mobileAssinanteId</con2:path></con2:param><con2:param name="netHeader1"><con2:path>$header//netheader:NetHeader</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7fed</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarDadosFaturamentoClienteRequest</con3:xqueryText></con2:expr><con2:message>consultarDadosFaturamentoClienteRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7fec</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarDadosFaturamentoClienteResponse</con3:xqueryText></con2:expr><con2:message>consultarDadosFaturamentoClienteResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fef</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node() ne ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="exceptionStackTrace"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fee</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node()</con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe6</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$exceptionStackTrace</con3:xqueryText></con2:expr><con2:message>exceptionStackTrace</con2:message></con2:log><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe4</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node())), 'TechnicalFault')
or 
fn:contains(xs:string(fn:name($consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node())), 'ParametroInvalidoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe3</con2:id><con1:errCode>ESB-CLIEN-0019</con1:errCode><con1:message>Erro durante a execução do recurso: {0}.</con1:message></con1:Error></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node())), 'ClienteNaoEncontradoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe2</con2:id><con1:errCode>ESB-CLIEN-0041</con1:errCode><con1:message>Cliente Claro não encontrado.</con1:message></con1:Error></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($consultarDadosFaturamentoClienteResponse/soap12-env:Detail/node())), 'ContaNaoEncontradaFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe1</con2:id><con1:errCode>ESB-CLIEN-0042</con1:errCode><con1:message>Conta não encontrado.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:assign varName="assinante"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff0</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<cli:assinante>
	<cli:dadosCadastrais>
		{
	   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:accounts/v11:account/v11:mobile-ban) ne '')then
				<cli:mobileBan>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:accounts/v11:account/v11:mobile-ban)}</cli:mobileBan>	   		
	   		else()
		}
		{
	   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:data-nascimento) ne '')then
		    	<cli:dataNascimento>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:data-nascimento)}</cli:dataNascimento>
	   		else()
		}
		{
	   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nacionalidade) ne '')then
		    	<cli:nacionalidade>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nacionalidade)}</cli:nacionalidade>
	   		else()
		}
		{
	   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nome-mae) ne '')then
		    	<cli:nomeMae>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:nome-mae)}</cli:nomeMae>
	   		else()
		}
		{
	   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:passaporte) ne '')then
		    	<cli:passaporte>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:passaporte)}</cli:passaporte>
	   		else()
		}
		{
    		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg) ne '')then
		    	<cli:RG>
		 			{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:numero) ne '')then
		 	   				<cli:numero>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:numero)}</cli:numero>
	   					else()
					}
		 			{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:orgao-emissor) ne '')then
				       		<cli:orgaoExpedidor>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:orgao-emissor)}</cli:orgaoExpedidor>
	   					else()
					}
		 			{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:data-emissao) ne '')then
				       		<cli:dataExpedicao>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rg/v11:data-emissao)}</cli:dataExpedicao>
	   					else()
					}
		    	</cli:RG>
		    else()
		}
		{
			if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne) ne '')then
    			<cli:RNE>
    				{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:numero) ne '')then
				 	   		<cli:numero>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:numero)}</cli:numero>
	   					else()
					}
    				{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:orgao-emissor) ne '')then
		      				<cli:orgaoEmissor>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:orgao-emissor)}</cli:orgaoEmissor>
	   					else()
					}  	  				
    				{
	   					if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:data-emissao) ne '')then
		      				<cli:dataExpedicao>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:dados-cadastrais-pf/v11:rne/v11:data-emissao)}</cli:dataExpedicao>
	   					else()
					}
    			</cli:RNE>
    		else()
    	}
    	{
    		if (data($assinante/v11:titularidade-assinante/v11:indicador-titular) ne '' or data($assinante/v11:aparelho/v11:msisdn) ne '')then
    			<cli:telefones>
    				<cli:telefone>
     					{
	   						if (data($assinante/v11:titularidade-assinante/v11:indicador-titular) ne '')then
				      			<cli:indicadorTitularidade>{data($assinante/v11:titularidade-assinante/v11:indicador-titular)}</cli:indicadorTitularidade>
	   						else()
						}   				
     					{
	   						if (data($assinante/v11:aparelho/v11:msisdn) ne '')then
		            			<cli:MSISDN>{data($assinante/v11:aparelho/v11:msisdn)}</cli:MSISDN>
	   						else()
						}         				
        			</cli:telefone>
   				</cli:telefones>
   			else()
   		}
   		{
    		if (data($assinante/v11:tipo-assinatura) ne '')then
		  		<cli:tipoAssinatura>{data($assinante/v11:tipo-assinatura)}</cli:tipoAssinatura>
    		else()
    	}
    	{
    		if (data($assinante/v11:tipo-servico) ne '')then
		  		<cli:tipoServico>{data($assinante/v11:tipo-servico)}</cli:tipoServico>
    		else()
    	} 
	</cli:dadosCadastrais>
	{
   		if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:contratos/v11:contrato/v11:ciclo-faturamento/v11:dia-vencimento) ne '' or data($calcularMultaAssinanteResponse/v2:multas/v11:multa/v11:valor) ne '')then
			<cli:dadosFaturamento>
				{
	   				if (data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:contratos/v11:contrato/v11:ciclo-faturamento/v11:dia-vencimento) ne '')then
						<cli:diaVencimento>{data($consultarDadosFaturamentoClienteResponse/v1:cliente/v11:contratos/v11:contrato/v11:ciclo-faturamento/v11:dia-vencimento)}</cli:diaVencimento>
	   				else()
				}  
			</cli:dadosFaturamento>
		else()
	}
</cli:assinante>]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fb5</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$assinante</con3:xqueryText></con2:expr><con2:message>assinante</con2:message></con2:log></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:insert varName="assinanteList"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ffd</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./cli:assinantes</con2:xpathText></con1:location><con1:where>last-child</con1:where><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$assinante</con2:xqueryText></con1:expr></con1:insert><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ffc</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$assinanteList</con3:xqueryText></con2:expr><con2:message>assinanteList</con2:message></con2:log><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ffb</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<cli:resultadoListar>
	{$assinanteList/cli:assinantes}
	{
		if(data($listarAssinantesResponse/v1:total-registros) ne '')then
    		<cli:paginacao>
	    		<cli:totalRegistros>{data($listarAssinantesResponse/v1:total-registros)}</cli:totalRegistros>
    		</cli:paginacao>
    	else()
    }
</cli:resultadoListar>]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ffa</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:actions></con1:case><con1:default><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-40259337784057347--3d7e186b.14dd94555d4.-7ffc</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$tipoPessoa</con3:xqueryText></con2:expr><con2:message>Assinante Pessoa Juridica</con2:message></con2:log><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff4</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cli:resultadoListar/></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff3</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:default><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fd3</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$situacao</con3:xqueryText></con2:expr><con2:message>Situacao da assinatura</con2:message></con2:log><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fd6</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($countAssinante) eq 1</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fd5</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cli:resultadoListar/></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fd4</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:actions></con1:case><con1:default><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fd0</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string-length($tipoPessoa) eq 0</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fcf</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cli:resultadoListar/></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-5275799705042531562--3d20bbf9.14fd2cb2f56.-7fce</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:default></con1:ifThenElse></con1:default></con1:ifThenElse></con1:actions>
          </con1:foreach></con1:actions></con1:case><con1:default><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff9</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;cli:resultadoListar/></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff8</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:default></con1:ifThenElse></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fad</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="relacionar/cliente/clienteclaro/businessservice/CalcularMultaAssinanteBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>calcularMultaAssinante</con1:operation><con1:request><con1:body>$calcularMultaAssinanteRequest</con1:body></con1:request><con1:response><con1:body>calcularMultaAssinanteResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="businessService"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fac</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'CalcularMultaAssinanteBSV1_0'</con2:xqueryText></con1:expr></con1:assign><con1:assign varName="calcularMultaAssinanteRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fab</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="relacionar/cliente/clienteclaro/transformation/xquery/TransformarCalcularMultaAssinanteRequestXQuery"/><con2:param name="parametrosListar1"><con2:path>$body/cli:parametrosListar</con2:path></con2:param><con2:param name="netHeader1"><con2:path>$header//netheader:NetHeader</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2891690681958490031--483f1441.14ea7207b07.-8000</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$calcularMultaAssinanteRequest</con3:xqueryText></con2:expr><con2:message>calcularMultaAssinanteRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2891690681958490031--483f1441.14ea7207b07.-7fff</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$calcularMultaAssinanteResponse</con3:xqueryText></con2:expr><con2:message>calcularMultaAssinanteResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fe0</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$calcularMultaAssinanteResponse/soap12-env:Detail/node() ne ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="exceptionStackTrace"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fdf</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$calcularMultaAssinanteResponse/soap12-env:Detail/node()</con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fd5</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$exceptionStackTrace</con3:xqueryText></con2:expr><con2:message>exceptionStackTrace</con2:message></con2:log><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fdd</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($calcularMultaAssinanteResponse/soap12-env:Detail/node())), 'TechnicalFault')
or 
fn:contains(xs:string(fn:name($calcularMultaAssinanteResponse/soap12-env:Detail/node())), 'ParametroInvalidoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fda</con2:id><con1:errCode>ESB-CLIEN-0019</con1:errCode><con1:message>Erro durante a execução do recurso: {0}.</con1:message></con1:Error></con1:actions></con1:case><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains(xs:string(fn:name($calcularMultaAssinanteResponse/soap12-env:Detail/node())), 'AssinanteNaoEncontradoFault')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2450707345436285423--63f3f167.14e468e6df0.-7fd9</con2:id><con1:errCode>ESB-CLIEN-0040</con1:errCode><con1:message>Assinante Claro não encontrado.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:assign varName="resultadoListar"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fb4</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<cli:resultadoListar>
	{
   		if (data($calcularMultaAssinanteResponse/v2:multas/v11:multa/v11:valor) ne '')then
			<cli:assinantes>
			<cli:assinante>
				<cli:dadosFaturamento>
    				<cli:valorMulta>{data($calcularMultaAssinanteResponse/v2:multas/v11:multa/v11:valor)}</cli:valorMulta>
				</cli:dadosFaturamento>
		</cli:assinante>
			</cli:assinantes>
		else()
	}
</cli:resultadoListar>
]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-690063590442990904--33c8a1a2.14ea6e9fd0a.-7fb3</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$resultadoListar</con3:xqueryText></con2:expr><con2:message>resultadoListar</con2:message></con2:log></con1:default></con1:ifThenElse></con1:default></con1:ifThenElse></con:actions></con:stage>
      
    </con:pipeline>
    <con:pipeline type="response" name="Operacao Listar_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Retorno ao cliente"><con:comment>Estagio que realiza o tratamento do retorno antes de ser enviado ao cliente.</con:comment><con:context/><con:actions><con1:replace varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff7</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Header/></con2:xqueryText></con1:expr></con1:replace><con1:replace varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff6</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Body>
	{ $resultadoListar }
&lt;/soap12-env:Body></con2:xqueryText></con1:expr></con1:replace><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7001616218377369428-1ce5a9bf.14dd9a24ee7.-7ff5</con2:id><con1:logLevel>debug</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText></con1:expr><con1:message>Retorno ao cliente</con1:message></con1:log></con:actions></con:stage></con:pipeline>
    
    <con:pipeline type="error" name="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fd7" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Tratamento de erro dos request entrada"><con:comment>Estagio que realiza o tratamento de erros quando um erro de request invalido </con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd6</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro na validação de request invalido</con1:message></con1:log><con1:assign varName="localMessageParameters" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd5</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>
	&lt;logging:value>{$operation}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd4</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/><con2:param name="additionalInformation"><con2:path>$null</con2:path></con2:param><con2:param name="currentFault"><con2:path>$fault</con2:path></con2:param><con2:param name="exceptionStackTrace"><con2:path>fn:data($fault/ctx:details)</con2:path></con2:param><con2:param name="accessResourceName"><con2:path>''</con2:path></con2:param><con2:param name="responseSOAPVersion"><con2:path>'1.2'</con2:path></con2:param><con2:param name="currentBody"><con2:path>$body</con2:path></con2:param><con2:param name="exceptionClassification"><con2:path>'CLASSIFICATION_VALIDATION'</con2:path></con2:param><con2:param name="processo"><con2:path>'cliente'</con2:path></con2:param><con2:param name="messageParameters"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="macroProcesso"><con2:path>'RELACIONAR'</con2:path></con2:param><con2:param name="validationMessages"><con2:path>&lt;validationMessages/></con2:path></con2:param><con2:param name="callResponse"><con2:path>$null</con2:path></con2:param><con2:param name="messageCode"><con2:path>'ESB-CLIEN-0026'</con2:path></con2:param><con2:param name="currentInbound"><con2:path>$inbound</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fd3</con2:id><con1:errCode>LOCAL_EXCEPTION</con1:errCode></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fcd" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Tratamento de erro validacao de Campos obrigatórios"><con:comment>Estagio que realiza o tratamento de erros quando um erro de validacao de Campos obrigatórios</con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fcc</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro na validação de campos obrigatorios</con1:message></con1:log><con1:assign varName="localMessageParameters" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fcb</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>
	&lt;logging:value>{$campo}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fc9</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/><con2:param name="additionalInformation"><con2:path>$null</con2:path></con2:param><con2:param name="currentFault"><con2:path>$fault</con2:path></con2:param><con2:param name="exceptionStackTrace"><con2:path>fn:data($fault/ctx:details)</con2:path></con2:param><con2:param name="accessResourceName"><con2:path>''</con2:path></con2:param><con2:param name="responseSOAPVersion"><con2:path>'1.2'</con2:path></con2:param><con2:param name="currentBody"><con2:path>$body</con2:path></con2:param><con2:param name="exceptionClassification"><con2:path>'CLASSIFICATION_VALIDATION'</con2:path></con2:param><con2:param name="messageParameters"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="processo"><con2:path>'cliente'</con2:path></con2:param><con2:param name="macroProcesso"><con2:path>'RELACIONAR'</con2:path></con2:param><con2:param name="validationMessages"><con2:path>&lt;validationMessages/></con2:path></con2:param><con2:param name="callResponse"><con2:path>$null</con2:path></con2:param><con2:param name="messageCode"><con2:path>data($fault/ctx:errorCode)</con2:path></con2:param><con2:param name="currentInbound"><con2:path>$inbound</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fca</con2:id><con1:errCode>LOCAL_EXCEPTION</con1:errCode></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-6557466325502325539-3822d17c.14dd3622820.-7fb1" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Estágio Error Handler Proxy"><con:comment>Estágio onde é feito o tratamento de erro global do proxy.</con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/errorinfo" prefix="errorInfo" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fb0</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro no proxy ClienteClaro12V1</con1:message></con1:log><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7faf</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($errorHandlerRequest)</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="validationMessages"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fae</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="localMessageParameters"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fad</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>
	&lt;logging:value>{concat($businessService,': Proxy ClienteClaro12V1')}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="errorHandlerRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fac</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/><con2:param name="additionalInformation"><con2:path>$null</con2:path></con2:param><con2:param name="currentFault"><con2:path>$fault</con2:path></con2:param><con2:param name="exceptionStackTrace"><con2:path>''</con2:path></con2:param><con2:param name="accessResourceName"><con2:path>''</con2:path></con2:param><con2:param name="responseSOAPVersion"><con2:path>'1.2'</con2:path></con2:param><con2:param name="currentBody"><con2:path>$body</con2:path></con2:param><con2:param name="exceptionClassification"><con2:path>'CLASSIFICATION_UNEXPECTED'</con2:path></con2:param><con2:param name="messageParameters"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="processo"><con2:path>'cliente'</con2:path></con2:param><con2:param name="macroProcesso"><con2:path>'RELACIONAR'</con2:path></con2:param><con2:param name="validationMessages"><con2:path>$validationMessages</con2:path></con2:param><con2:param name="callResponse"><con2:path>$null</con2:path></con2:param><con2:param name="messageCode"><con2:path>'ESB-CLIEN-0019'</con2:path></con2:param><con2:param name="currentInbound"><con2:path>$inbound</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fab</con2:id><con1:service xsi:type="ref:ProxyRef" ref="general/NETESBExceptionHandler/proxyservice/NETESBExceptionHandler12V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>convertLocalExceptionToFault</con1:operation><con1:request><con1:body>$errorHandlerRequest</con1:body></con1:request><con1:response><con1:body>errorHandlerResponse</con1:body></con1:response><con1:requestTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7faa</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$errorHandlerRequest</con3:xqueryText></con2:expr><con2:message>errorHandlerRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa9</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse</con3:xqueryText></con2:expr><con2:message>errorHandlerResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa8</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">($inbound//ctx:transport/ctx:request/http:client-host/node() and
$inbound//ctx:transport/ctx:request/http:client-host ne "")
or
($inbound//ctx:transport/ctx:request/http:client-address/node() and
$inbound//ctx:transport/ctx:request/http:client-address ne "")</con2:xqueryText></con1:condition><con1:actions><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa5</con3:id><con2:logLevel>debug</con2:logLevel><con2:message>Chamada Externa, gerar Log e Alerta ClienteClaro12V1.proxy</con2:message></con2:log><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa7</con2:id><con1:service xsi:type="ref:ProxyRef" ref="general/NETLog/proxyservice/FormatLogMessage12" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>formatLogMessage</con1:operation><con1:request><con1:body>$formatLogMessageRequest</con1:body></con1:request><con1:response><con1:body>formatLogMessageResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="formatLogMessageRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa6</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<for:logMessage xmlns:log="http://www.netservicos.com.br/modelocanonico/v2/logging" xmlns:for="http://www.netservicos.com.br/FormatLogMessage">
   <log:transactionId>{fn:data($header//token)}</log:transactionId>
   <log:logType>ERROR</log:logType>
   <log:messageCode>{ fn:data($errorHandlerRequest/excephdlr:messageCode) }</log:messageCode>
   <log:messageParameters>{ $errorHandlerRequest/excephdlr:messageParameters }</log:messageParameters>
   <log:username>{fn:data($header//username)}</log:username>
   <log:timestamp>{fn:data(fn:current-dateTime())}</log:timestamp>
   <log:errorInfo>{ $errorHandlerResponse//errorInfo:ErrorInfo/@* , $errorHandlerResponse//errorInfo:ErrorInfo/node() }</log:errorInfo>
   <log:macroProcesso>RELACIONAR</log:macroProcesso>
   <log:processo>cliente</log:processo>
   <log:consumidor>{fn:data($header//aplicacao)}</log:consumidor>
</for:logMessage>]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa1</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$formatLogMessageRequest</con3:xqueryText></con2:expr><con2:message>formatLogMessageRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa0</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$formatLogMessageResponse</con3:xqueryText></con2:expr><con2:message>formatLogMessageResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:wsCallout><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9f</con2:id><con1:service xsi:type="ref:ProxyRef" ref="general/NETAlert/proxyservice/Alert12" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>alert</con1:operation><con1:request><con1:body>$alertRequest</con1:body></con1:request><con1:response><con1:body>alertResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="alertRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9e</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aler1:alert xmlns:aler="http://www.netservicos.com.br/modelocanonico/v2/alert" xmlns:aler1="http://www.netservicos.com.br/Alert">
    <aler:timestamp>{data(fn:current-dateTime())}</aler:timestamp>
    <aler:transactionId>{fn:data($header//token)}</aler:transactionId>
    <aler:message>{fn:data($formatLogMessageResponse/logging:message)}</aler:message>
    <aler:serviceSeverityLevel>NIVEL1</aler:serviceSeverityLevel>
    <aler:consumidor>{fn:data($header//aplicacao)}</aler:consumidor>
    <aler:macroProcesso>RELACIONAR</aler:macroProcesso>
    <aler:macroProcessoNivel>cliente</aler:macroProcessoNivel>
    <aler:macroProcessoSubNivel></aler:macroProcessoSubNivel>
    <aler:exceptionClassification>{fn:data($errorHandlerResponse//errorInfo:ErrorInfo/exceptionClassification)}</aler:exceptionClassification>
</aler1:alert>]]></con2:xqueryText></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9d</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$alertRequest</con3:xqueryText></con2:expr><con2:message>alertRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9c</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$alertResponse</con3:xqueryText></con2:expr><con2:message>alertResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9b</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:exists($errorHandlerResponse/soap12-env:Fault)</con2:xqueryText></con1:condition><con1:actions><con1:replace contents-only="true" varName="body"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f9a</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/soap12-env:Fault</con2:xqueryText></con1:expr></con1:replace><con1:replace varName="header"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f99</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Header/></con2:xqueryText></con1:expr></con1:replace></con1:actions></con1:case><con1:default><con1:replace contents-only="true" varName="body"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f98</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/soap-env:Fault</con2:xqueryText></con1:expr></con1:replace><con1:replace varName="header"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f97</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap-env:Header/></con2:xqueryText></con1:expr></con1:replace></con1:default></con1:ifThenElse><con2:reply isError="true" xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:id>_ActionId-6557466325502325539-3822d17c.14dd3622820.-7f96</con2:id></con2:reply></con1:actions></con1:case><con1:default><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa4</con3:id><con2:logLevel>debug</con2:logLevel><con2:message>Chamada Interna ClienteClaro12V1.proxy</con2:message></con2:log><con1:replace varName="fault"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa3</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/ctx:fault</con2:xqueryText></con1:expr></con1:replace><con1:replace varName="header"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6557466325502325539-3822d17c.14dd3622820.-7fa2</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Header/></con2:xqueryText></con1:expr></con1:replace></con1:default></con1:ifThenElse></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-2891690681958490031--483f1441.14ea7207b07.-7ffe" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Tratamento de erro lista dados assinantes ou calculo de multa"><con:comment>Estágio de tratamento de execao para a chamada ao serviço externo da Claro</con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2891690681958490031--483f1441.14ea7207b07.-7ffd</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro ao validar listar assinantes</con1:message></con1:log><con1:assign varName="localMessageParameters" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2891690681958490031--483f1441.14ea7207b07.-7ffc</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>
	&lt;logging:value>{$businessService}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText></con1:expr></con1:assign><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1370919522158274975--73ce7db6.14ed0189044.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($exceptionStackTrace) ne ''</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="errorHandlerRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5741601606535480737-1504c851.14ddf4ebc28.-8000</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/><con2:param name="additionalInformation"><con2:path>$null</con2:path></con2:param><con2:param name="currentFault"><con2:path>$fault</con2:path></con2:param><con2:param name="exceptionStackTrace"><con2:path>fn:data($exceptionStackTrace)</con2:path></con2:param><con2:param name="accessResourceName"><con2:path>''</con2:path></con2:param><con2:param name="responseSOAPVersion"><con2:path>'1.2'</con2:path></con2:param><con2:param name="currentBody"><con2:path>$body</con2:path></con2:param><con2:param name="exceptionClassification"><con2:path>'CLASSIFICATION_RESOURCE'</con2:path></con2:param><con2:param name="processo"><con2:path>'cliente'</con2:path></con2:param><con2:param name="messageParameters"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="macroProcesso"><con2:path>'RELACIONAR'</con2:path></con2:param><con2:param name="callResponse"><con2:path>$null</con2:path></con2:param><con2:param name="validationMessages"><con2:path>&lt;validationMessages/></con2:path></con2:param><con2:param name="messageCode"><con2:path>data($fault/ctx:errorCode)</con2:path></con2:param><con2:param name="currentInbound"><con2:path>$inbound</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7961976024754066544--26e94cfe.14de8effcbe.-7ff3</con2:id><con1:errCode>LOCAL_EXCEPTION</con1:errCode></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse></con:actions></con:stage></con:pipeline><con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:branch-node type="operation" name="ClienteClaro12V1">
        <con:context/>
        <con:branch-table>
          <con:branch name="listar">
            <con:operator>equals</con:operator>
            <con:value/>
            <con:flow>
              <con:pipeline-node name="Operacao Listar">
                <con:comment>Responsavel por listar as informações dos clientes Claro</con:comment><con:request>Operacao Listar_request</con:request>
                <con:response>Operacao Listar_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow>
              
            </con:flow>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>