<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment>
  <ser:coreEntry isProxy="true" isEnabled="true" xmlns:ser="http://www.bea.com/wli/sb/services">
    <ser:description>Proxy JMS que provê acesso as mensagens da fila inseridas pelo serviço OrdemAtivacaoStatus</ser:description>
    <ser:binding type="Mixed" xsi:type="con:MixedBindingType" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
      <con:request type="XML">
        <con1:schema ref="ativar/aprovisionamento/mediacao/schemas/MensagemMediacao" element="mensagemMediacao" xmlns:con1="http://www.bea.com/wli/sb/typesystem/config"/>
      </con:request>
      <con:response type="XML">
        <con1:schema ref="ativar/aprovisionamento/mediacao/schemas/MensagemMediacao" element="mensagemMediacao" xmlns:con1="http://www.bea.com/wli/sb/typesystem/config"/>
      </con:response>
    </ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
  </ser:coreEntry>
  <ser:endpointConfig xmlns:ser="http://www.bea.com/wli/sb/services">
    <tran:provider-id xmlns:tran="http://www.bea.com/wli/sb/transports">jms</tran:provider-id>
    <tran:inbound xmlns:tran="http://www.bea.com/wli/sb/transports">true</tran:inbound>
    <tran:URI xmlns:tran="http://www.bea.com/wli/sb/transports">
      <env:value xmlns:env="http://www.bea.com/wli/config/env">jms://5.16.41.46:8102,5.16.41.46:8103,5.16.41.46:8104,5.16.41.47:8105,5.16.41.47:8106,5.16.41.47:8107,5.16.41.47:8108,5.16.41.47:8109,5.16.41.48:8110,5.16.41.48:8/netservicos.connectionFactory.Mediacao/netservicos.queue.ativar.mediacao.MediacaoQueue</env:value>
    </tran:URI>
    <tran:inbound-properties xmlns:tran="http://www.bea.com/wli/sb/transports"/>
    <tran:all-headers xmlns:tran="http://www.bea.com/wli/sb/transports">false</tran:all-headers>
    <tran:provider-specific xmlns:tran="http://www.bea.com/wli/sb/transports"><jms:is-queue xmlns:jms="http://www.bea.com/wli/sb/transports/jms">true</jms:is-queue><jms:is-secure xmlns:jms="http://www.bea.com/wli/sb/transports/jms">false</jms:is-secure><jms:inbound-properties xmlns:jms="http://www.bea.com/wli/sb/transports/jms"><jms:response-required>false</jms:response-required><jms:XA-required>false</jms:XA-required></jms:inbound-properties><jms:request-encoding xmlns:jms="http://www.bea.com/wli/sb/transports/jms">UTF-8</jms:request-encoding></tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-4352448323641376182--72290dc3.14f9a3b96ef.-7eed" xmlns:ser="http://www.bea.com/wli/sb/services">
    <con:pipeline type="request" name="PipelinePairNode1_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Identifica Operadora Net" errorHandler="_onErrorHandler-3891594539591728427--40f69a14.14faea79c3f.-7fc0">
        <con:comment>Estágio onde é feita a chamada ao serviço IdentificacaoOperadoraNET12V1.identificarOperadoraNET,
este serviço faz as validações pertinentes e identifica a Operadora Net</con:comment>
        <con:context>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/OrdemAtivacaoV1/" prefix="ord" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/MediacaoV1/" prefix="med" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/MensagemMediacao" prefix="men" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/identificacaoOperadoraNET" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fca</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="general/NETSMSDatabaseConfig/proxyservice/IdentificacaoOperadoraNET12V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>identificarOperadoraNET</con1:operation>
            <con1:request>
              <con1:body>$identificarOperadoraNETRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>identificarOperadoraNETResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="identificarOperadoraNETRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4886297140046139592-5a02f8b7.14fb38b1121.-7ffd</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="ativar/aprovisionamento/mediacao/transformation/xquery/MediacaoOperadoraNETRequestXQuery"/>
                    <con2:param name="mensagemMediacao1">
                      <con2:path>$body/men:mensagemMediacao</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1329109486734490451--12694915.128f3b8d2c2.-7c42</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>Request identificarOperadoraNET</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-1329109486734490451--12694915.128f3b8d2c2.-7c40</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>Response identificarOperadoraNET</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Consulta Ordem no DSP" errorHandler="_onErrorHandler-7142622860427203207--21c666f.15844308e20.-7ff6">
        <con:comment>Consulta Ordem no DSP</con:comment>
        <con:context>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/MensagemMediacao" prefix="men" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fe6</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="ativar/aprovisionamento/mediacao/businessservice/MediacaoConsultaOrdemBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>consultarPorID</con1:operation>
            <con1:request>
              <con1:body>$consultarPorIDRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>consultarPorIDResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fb8</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>#CARMEM identificarOperadoraNETResponse</con2:message>
              </con2:log>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-8152361863280397799--523bd532.14fb7a95324.-7fff</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con3:xqueryText>
                </con2:expr>
                <con2:message>base de dados::</con2:message>
              </con2:log>
              <con1:transport-headers>
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fbc</con2:id>
                <con1:header-set>outbound-request</con1:header-set>
                <con1:header name="j_identity_base" value="expression">
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText>
                </con1:header>
              </con1:transport-headers>
              <con1:assign varName="consultarPorIDRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fe9</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="ativar/aprovisionamento/mediacao/transformation/xquery/MediacaoConsultarPorIDRequestXQuery"/>
                    <con2:param name="mensagemMediacao1">
                      <con2:path>$body/men:mensagemMediacao</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
              
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-8152361863280397799--523bd532.14fb7a95324.-8000</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarPorIDRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>consultarPorIDRequest</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fe2</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarPorIDResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>consultarPorIDResponse</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Valida se Ordem foi localizada" errorHandler="_onErrorHandler-7142622860427203207--21c666f.15844308e20.-7ff2">
        <con:comment>Validação do retorno de consulta da ordem de ativação na camada do DSP.</con:comment><con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/OrdemAtivacao/schemas" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7f1d</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($consultarPorIDResponse/ns0:OrdemAtivacao)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-8474145102821745293-429ce1b8.14f75718dc4.-8000</con3:id>
                  <con2:logLevel>debug</con2:logLevel>
                  <con2:message>Ordem nao encontrada!</con2:message>
                </con2:log>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Consulta se Ordem tem Mediação" errorHandler="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-8000">
        <con:comment>Stage para consulta se a Ordem tem Mediação</con:comment><con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/OrdemAtivacao/schemas" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        <con1:varNsDecl namespace="http://www.netservicos.com.br/MensagemMediacao" prefix="men" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7f15</con2:id>
            <con1:logLevel>warning</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:string-join((fn:data($consultarPorIDResponse/ns0:OrdemAtivacao/ns0:tipoOrdemAtivacao/ns0:identificador), fn:data($consultarPorIDResponse/ns0:OrdemAtivacao/ns0:identificadorTipoSolicitacao), fn:data($consultarPorIDResponse/ns0:OrdemAtivacao/ns0:identificadorTipoOC)), '_')</con2:xqueryText>
            </con1:expr>
            <con1:message>tipoOrdemAtivacao_tipoSolicitacao_tipoOC</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-8000</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="ativar/aprovisionamento/mediacao/businessservice/MediacaoConsultaFiltroBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>consultarMediacao</con1:operation><con1:request><con1:body>$consultarMediacaoRequest</con1:body></con1:request><con1:response><con1:body>consultarMediacaoResponse</con1:body></con1:response><con1:requestTransform><con1:transport-headers><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-7fff</con2:id><con1:header-set>outbound-request</con1:header-set><con1:header name="j_identity_base" value="expression"><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText></con1:header></con1:transport-headers><con1:assign varName="consultarMediacaoRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-7ffd</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="ativar/aprovisionamento/mediacao/transformation/xquery/MediacaoConsultaFiltroRequestXQuery"/><con2:param name="mensagemMediacao1"><con2:path>$body/men:mensagemMediacao</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-7ffc</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarMediacaoRequest</con3:xqueryText></con2:expr><con2:message>consultarMediacaoRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-7ffb</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$consultarMediacaoResponse</con3:xqueryText></con2:expr><con2:message>consultarMediacaoResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Valida se Ordem tem Mediação" errorHandler="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-7ffc"><con:comment>Stage para validar se Ordem tem Mediação</con:comment><con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/mediacao/schemas" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7f12</con2:id>
            <con1:case>
              <con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($consultarMediacaoResponse/ns0:mediacao/ns0:flagMediacao) eq 'SIM'</con2:xqueryText></con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-8152361863280397799--523bd532.14fb7a95324.-7ffe</con3:id>
                  <con2:logLevel>info</con2:logLevel>
                  <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:data($consultarPorIDResponse/ns0:OrdemAtivacao/ns0:identificadorOrdemAtivacao)</con3:xqueryText></con2:expr>
                  <con2:message>Ordem TEM mediacao, idOrdemAtivacao</con2:message>
                </con2:log>
              </con1:actions>
            </con1:case>
            
            <con1:default>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4666842523361333000-280af77e.14f8463f7a6.-8000</con3:id>
                <con2:logLevel>info</con2:logLevel>
                <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:data($consultarPorIDResponse/ns0:OrdemAtivacao/ns0:identificadorOrdemAtivacao)</con3:xqueryText></con2:expr>
                <con2:message>Ordem NAO TEM mediacao, idOrdemAtivacao</con2:message>
              </con2:log>
            <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:id>_ActionId-3071797078903672051--1f324dd9.1507215ec2b.-7ffa</con2:id></con2:reply></con1:default>
          </con1:ifThenElse></con:actions></con:stage><con:stage name="Chamada para WLI" errorHandler="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-7ff4">
        <con:comment>Stage para Chamada do Webservice do WLI</con:comment><con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/OrdemAtivacao/schemas" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:varNsDecl namespace="http://www.netservicos.com.br/MensagemMediacao" prefix="men" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-8000</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="ativar/aprovisionamento/mediacao/businessservice/MediacaoBSV1_0" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>executarMediacao</con1:operation>
            <con1:request>
              <con1:body wrapped="true">$executarMediacaoRequest</con1:body>
              
            </con1:request>
            <con1:response>
              <con1:body wrapped="true">executarMediacaoResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ffb</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarOperadoraNETResponse</con2:message>
              </con2:log>
              <con1:transport-headers>
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ffd</con2:id>
                <con1:header-set>outbound-request</con1:header-set>
                <con1:header name="j_identity_base" value="expression">
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText>
                </con1:header>
              </con1:transport-headers>
              <con1:assign varName="executarMediacaoRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ff9</con2:id>
                <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="ativar/aprovisionamento/mediacao/transformation/xquery/ExecutarMediacaoRequestXQuery"/><con2:param name="ordemAtivacao1"><con2:path>$consultarPorIDResponse/ns0:OrdemAtivacao</con2:path></con2:param><con2:param name="mensagemMediacao1"><con2:path>$body/men:mensagemMediacao</con2:path></con2:param></con2:xqueryTransform></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7fff</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$executarMediacaoRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>executarMediacaoRequest</con2:message>
              </con2:log>
              <con1:assign varName="executarMediacaoRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ff8</con2:id>
                <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap-env:Body>
	{$executarMediacaoRequest}
&lt;/soap-env:Body></con2:xqueryText></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ff3</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$executarMediacaoRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>>>>>>>>>>>>>>>>>>>>>>>>executarMediacaoRequest - body</con2:message>
              </con2:log>
              
              
              
              
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4123799345056996795-176749e3.14fbea8f841.-7ffe</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$executarMediacaoResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>executarMediacaoResponse</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="PipelinePairNode1_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"/>
    <con:pipeline type="error" name="_onErrorHandler-4352448323641376182--72290dc3.14f9a3b96ef.-7eed" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Estágio Error Handler Proxy">
        <con:comment>Estágio de tratamento de erro geral.</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/errorinfo" prefix="errorInfo" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7eec</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>Erro no proxy Mediacao12V1</con1:message>
          </con1:log>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7eeb</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($errorHandlerRequest)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con1:assign varName="validationMessages">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f8a</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="localMessageParameters">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f8a</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="errorHandlerRequest">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f8a</con2:id>
                  <con1:expr>
                    <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                      <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                      <con2:param name="additionalInformation">
                        <con2:path>$null</con2:path>
                      </con2:param>
                      <con2:param name="currentFault">
                        <con2:path>$fault</con2:path>
                      </con2:param>
                      <con2:param name="exceptionStackTrace">
                        <con2:path>''</con2:path>
                      </con2:param>
                      <con2:param name="accessResourceName">
                        <con2:path>'OrdemAtivacaoStatus12V1.Estágio Error Handler Proxy'</con2:path>
                      </con2:param>
                      <con2:param name="responseSOAPVersion">
                        <con2:path>'1.2'</con2:path>
                      </con2:param>
                      <con2:param name="currentBody">
                        <con2:path>$body</con2:path>
                      </con2:param>
                      <con2:param name="exceptionClassification">
                        <con2:path>'CLASSIFICATION_UNEXPECTED'</con2:path>
                      </con2:param>
                      <con2:param name="messageParameters">
                        <con2:path>$localMessageParameters</con2:path>
                      </con2:param>
                      <con2:param name="processo">
                        <con2:path>'aprovisionamento'</con2:path>
                      </con2:param>
                      <con2:param name="macroProcesso">
                        <con2:path>'ATIVAR'</con2:path>
                      </con2:param>
                      <con2:param name="validationMessages">
                        <con2:path>$validationMessages</con2:path>
                      </con2:param>
                      <con2:param name="callResponse">
                        <con2:path>$null</con2:path>
                      </con2:param>
                      <con2:param name="messageCode">
                        <con2:path>'ESB-APROV-0008'</con2:path>
                      </con2:param>
                      <con2:param name="currentInbound">
                        <con2:path>$inbound</con2:path>
                      </con2:param>
                    </con2:xqueryTransform>
                  </con1:expr>
                </con1:assign>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7ee7</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="general/NETESBExceptionHandler/proxyservice/NETESBExceptionHandler12V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>convertLocalExceptionToFault</con1:operation>
            <con1:request>
              <con1:body>$errorHandlerRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>errorHandlerResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$errorHandlerRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>Request errorHandler</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>Response $errorHandler</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4352448323641376182--72290dc3.14f9a3b96ef.-7ee4</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">($inbound//ctx:transport/ctx:request/http:client-host/node() and
$inbound//ctx:transport/ctx:request/http:client-host ne "")
or
($inbound//ctx:transport/ctx:request/http:client-address/node() and
$inbound//ctx:transport/ctx:request/http:client-address ne "")</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                  <con2:logLevel>debug</con2:logLevel>
                  <con2:message>Chamada Externa, gerar Log e Alerta Mediacao12V1.proxy</con2:message>
                </con2:log>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f72</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="general/NETLog/proxyservice/FormatLogMessage12" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                  <con1:operation>formatLogMessage</con1:operation>
                  <con1:request>
                    <con1:body>$formatLogMessageRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>formatLogMessageResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="formatLogMessageRequest">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f71</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<for:logMessage xmlns:log="http://www.netservicos.com.br/modelocanonico/v2/logging" xmlns:for="http://www.netservicos.com.br/FormatLogMessage">
   <log:transactionId>{fn:data($header//token)}</log:transactionId>
   <log:logType>ERROR</log:logType>
   <log:messageCode>{ fn:data($errorHandlerRequest/excephdlr:messageCode) }</log:messageCode>
   <log:messageParameters>{ $errorHandlerRequest/excephdlr:messageParameters }</log:messageParameters>
   <log:username>{fn:data($header//username)}</log:username>
   <log:timestamp>{fn:data(fn:current-dateTime())}</log:timestamp>
   <log:errorInfo>{ $errorHandlerResponse//errorInfo:ErrorInfo/@* , $errorHandlerResponse//errorInfo:ErrorInfo/node() }</log:errorInfo>
   <log:macroProcesso>ATIVAR</log:macroProcesso>
   <log:processo>aprovisionamento</log:processo>
   <log:consumidor>{fn:data($header//aplicacao)}</log:consumidor>
</for:logMessage>]]></con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                      <con2:logLevel>debug</con2:logLevel>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$formatLogMessageRequest</con3:xqueryText>
                      </con2:expr>
                      <con2:message>Request formatLogMessage</con2:message>
                    </con2:log>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                      <con2:logLevel>debug</con2:logLevel>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$formatLogMessageResponse</con3:xqueryText>
                      </con2:expr>
                      <con2:message>Response formatLogMessage</con2:message>
                    </con2:log>
                  </con1:responseTransform>
                </con1:wsCallout>
                <con1:wsCallout>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f72</con2:id>
                  <con1:service xsi:type="ref:ProxyRef" ref="general/NETAlert/proxyservice/Alert12" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                  <con1:operation>alert</con1:operation>
                  <con1:request>
                    <con1:body>$alertRequest</con1:body>
                  </con1:request>
                  <con1:response>
                    <con1:body>alertResponse</con1:body>
                  </con1:response>
                  <con1:requestTransform>
                    <con1:assign varName="alertRequest">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f71</con2:id>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<aler1:alert xmlns:aler="http://www.netservicos.com.br/modelocanonico/v2/alert" xmlns:aler1="http://www.netservicos.com.br/Alert">
    <aler:timestamp>{data(fn:current-dateTime())}</aler:timestamp>
    <aler:transactionId>{fn:data($header//token)}</aler:transactionId>
    <aler:message>{fn:data($formatLogMessageResponse/logging:message)}</aler:message>
    <aler:serviceSeverityLevel>NIVEL1</aler:serviceSeverityLevel>
    <aler:consumidor>{fn:data($header//aplicacao)}</aler:consumidor>
    <aler:macroProcesso>ATIVAR</aler:macroProcesso>
    <aler:macroProcessoNivel>aprovisionamento</aler:macroProcessoNivel>
    <aler:macroProcessoSubNivel></aler:macroProcessoSubNivel>
    <aler:exceptionClassification>{fn:data($errorHandlerResponse//errorInfo:ErrorInfo/exceptionClassification)}</aler:exceptionClassification>
</aler1:alert>]]></con2:xqueryText>
                      </con1:expr>
                    </con1:assign>
                    <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                      <con2:logLevel>debug</con2:logLevel>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$alertRequest</con3:xqueryText>
                      </con2:expr>
                      <con2:message>Request alert</con2:message>
                    </con2:log>
                  </con1:requestTransform>
                  <con1:responseTransform>
                    <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                      <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                      <con2:logLevel>debug</con2:logLevel>
                      <con2:expr>
                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$alertResponse</con3:xqueryText>
                      </con2:expr>
                      <con2:message>Response alert</con2:message>
                    </con2:log>
                  </con1:responseTransform>
                </con1:wsCallout>
                <con1:ifThenElse>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f62</con2:id>
                  <con1:case>
                    <con1:condition>
                      <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:exists($errorHandlerResponse/soap12-env:Fault)</con2:xqueryText>
                    </con1:condition>
                    <con1:actions>
                      <con1:replace varName="body" contents-only="true">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                        <con1:location>
                          <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                          <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/soap12-env:Fault</con2:xqueryText>
                        </con1:expr>
                      </con1:replace>
                      <con1:replace varName="header">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                        <con1:location>
                          <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                          <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Header/></con2:xqueryText>
                        </con1:expr>
                      </con1:replace>
                    </con1:actions>
                  </con1:case>
                  <con1:default>
                    <con1:replace varName="body" contents-only="true">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                      <con1:location>
                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                      </con1:location>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/soap-env:Fault</con2:xqueryText>
                      </con1:expr>
                    </con1:replace>
                    <con1:replace varName="header">
                      <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                      <con1:location>
                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                      </con1:location>
                      <con1:expr>
                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap-env:Header/></con2:xqueryText>
                      </con1:expr>
                    </con1:replace>
                  </con1:default>
                </con1:ifThenElse>
                <con2:reply isError="true" xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                  <con2:id>_ActionId-3645977647574307871-2479de8.127de3015b9.-7f5c</con2:id>
                </con2:reply>
              </con1:actions>
            </con1:case>
            <con1:default>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f79</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:message>Chamada Interna Mediacao12V1.proxy</con2:message>
              </con2:log>
              <con1:replace varName="fault">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                <con1:location>
                  <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                </con1:location>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse/ctx:fault</con2:xqueryText>
                </con1:expr>
              </con1:replace>
              <con1:replace varName="header">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3645977647574307871-2479de8.127de3015b9.-7f6d</con2:id>
                <con1:location>
                  <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                </con1:location>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;soap12-env:Header/></con2:xqueryText>
                </con1:expr>
              </con1:replace>
            </con1:default>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline name="_onErrorHandler-3891594539591728427--40f69a14.14faea79c3f.-7fc0" type="error" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Estágio Error Handler Identificação OperadoraNET">
        <con:comment>Caso seja identificado algum erro durante a execução do serviço
IdentificacaoOperadoraNET12V1.identificarOperadoraNET, esse
estágio trata o erro lançado.</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fc5</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>Erro ao Identificar OperadoraNET</con1:message>
          </con1:log>
          <con1:assign varName="validationMessages" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fc4</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="localMessageParameters" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fc3</con2:id>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Identificação OperadoraNET'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText>
            </con1:expr>
          </con1:assign>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fc2</con2:id>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$identificarOperadoraNETRequest</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'general/NETSMSDatabaseConfig/proxyservice/IdentificacaoOperadoraNET12V1.proxy'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_RESOURCE'</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'aprovisionamento'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'ATIVAR'</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localCallResponse</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-APROV-0003'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-3891594539591728427--40f69a14.14faea79c3f.-7fc1</con2:id>
            <con1:errCode>ESB-APROV-0003</con1:errCode>
            <con1:message>Erro durante a execução do recurso: Identificar OperadoraNET.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-7142622860427203207--21c666f.15844308e20.-7ff6" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Stage para log durante consutla do DSP"><con:comment>Stage para log durante consutla do DSP</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7142622860427203207--21c666f.15844308e20.-7ff5</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro durante a chamada da consulta da ordem de ativação na camada do DSP.</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7142622860427203207--21c666f.15844308e20.-7ff4</con2:id><con1:errCode>ESB-MEDIAT-03</con1:errCode><con1:message>Erro durante a consulta da ordem de ativação na camada do DSP.</con1:message></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-7142622860427203207--21c666f.15844308e20.-7ff2" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Log erro durante a validação da ordem"><con:comment>Stage para Log erro durante a validação da ordem</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7142622860427203207--21c666f.15844308e20.-7ff1</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Log durante falha na consulta da ordem de ativação.</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7142622860427203207--21c666f.15844308e20.-7ff0</con2:id><con1:errCode>ESB-MEDIAT-04</con1:errCode><con1:message>Erro durante validação do retorno de consulta da ordem de ativação da camada do DSP.</con1:message></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-8000" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Log de erro durante a consutla da ordem."><con:comment>Stage para Log de erro durante a consutla da ordem.</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7fff</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Erro durante validação do retorno de consulta da ordem de ativação da camada do DSP.</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7ffe</con2:id><con1:errCode>ESB-MEDIAT-05</con1:errCode><con1:message>Erro durante validação do retorno de consulta da ordem de ativação da camada do DSP possui mediação.</con1:message></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-7ffc" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Log de erro durante validação de mediação"><con:comment>Stage de Log de erro durante validação de mediação</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7ffb</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Log de erro durante validação de mediação</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7ffa</con2:id><con1:errCode>ESB-MEDIAT-06</con1:errCode><con1:message>Erro durante a validação se a ordem  de ativação possui processo de mediação para execução.</con1:message></con1:Error></con:actions></con:stage></con:pipeline><con:pipeline type="error" name="_onErrorHandler-5268746511470679908--427ac34a.15844c84455.-7ff4" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Log de erro chamada Webservice WLI"><con:comment>Stage para Log de erro chamada Webservice WLI</con:comment><con:context/><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7ff3</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>Log de erro durante validação de mediação</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5268746511470679908--427ac34a.15844c84455.-7ff2</con2:id><con1:errCode>ESB-MEDIAT-07</con1:errCode><con1:message>Erro durante a chamada do Webservice na camada do WLI</con1:message></con1:Error></con:actions></con:stage></con:pipeline><con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:pipeline-node name="PipelinePairNode1">
        <con:request>PipelinePairNode1_request</con:request>
        <con:response>PipelinePairNode1_response</con:response>
      </con:pipeline-node>
    </con:flow>
  </ser:router>
</xml-fragment>