<?xml version="1.0" encoding="UTF-8"?>
<xml-fragment>
  <ser:coreEntry isProxy="true" isEnabled="true" xmlns:ser="http://www.bea.com/wli/sb/services">
    <ser:description>Proxy Service Identificar Contratos contem as operações para consultar contratos por codigoCliente, protocolo, documento e telefone.
Também possui a operação solicitarBuscaContratosMultiBase responsavel por solicitar o processamento paralelo para consultar contratos nas bases de dados ativas.</ser:description>
    <ser:binding type="SOAP" isSoap12="true" xsi:type="con:SoapBindingType" xmlns:con="http://www.bea.com/wli/sb/services/bindings/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:wsdl ref="Infraestrutura/transicao/relacionar/atendimento/wsdl/proxy/IdentificarContratos"/><con:port><con:name>IdentificarContratosSOAP12</con:name><con:namespace>http://www.netservicos.com.br/IdentificarContratos/</con:namespace></con:port><con:selector type="SOAP body"/></ser:binding>
    <ser:monitoring isEnabled="false">
      <ser:aggregationInterval>10</ser:aggregationInterval>
    </ser:monitoring>
    <ser:reporting>true</ser:reporting>
    <ser:logging isEnabled="true">
      <ser:logLevel>debug</ser:logLevel>
    </ser:logging>
    <ser:sla-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:sla-alerting>
    <ser:pipeline-alerting isEnabled="true">
      <ser:alertLevel>normal</ser:alertLevel>
    </ser:pipeline-alerting>
    <ser:ws-policy>
      <ser:binding-mode>wsdl-policy-attachments</ser:binding-mode>
    </ser:ws-policy>
  </ser:coreEntry>
  <ser:endpointConfig xmlns:ser="http://www.bea.com/wli/sb/services">
    <tran:provider-id xmlns:tran="http://www.bea.com/wli/sb/transports">http</tran:provider-id>
    <tran:inbound xmlns:tran="http://www.bea.com/wli/sb/transports">true</tran:inbound>
    <tran:URI xmlns:tran="http://www.bea.com/wli/sb/transports">
      <env:value xmlns:env="http://www.bea.com/wli/config/env">/infraestrutura/transicao/relacionar/atendimento/IdentificarContratos12V2</env:value>
    </tran:URI>
    <tran:inbound-properties xmlns:tran="http://www.bea.com/wli/sb/transports"/>
    <tran:all-headers xmlns:tran="http://www.bea.com/wli/sb/transports">true</tran:all-headers>
    <tran:provider-specific xmlns:tran="http://www.bea.com/wli/sb/transports"><http:inbound-properties xmlns:http="http://www.bea.com/wli/sb/transports/http"><http:client-authentication xsi:type="http:HttpBasicAuthenticationType" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/></http:inbound-properties></tran:provider-specific>
  </ser:endpointConfig>
  <ser:router errorHandler="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fec" xmlns:ser="http://www.bea.com/wli/sb/services">
    <con:pipeline type="error" name="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fec" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro Geral">
        <con:comment>Tratamento de Erro Geral</con:comment>
        <con:context><con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7feb</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: TRATAMENTO DE ERRO GERAL</con1:message>
          </con1:log>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">se a variavel errorHandlerRequest nao esteja
preenchida, então preenchera com o logo de erro.</con2:comment><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-7fff</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($errorHandlerRequest)</con2:xqueryText></con1:condition><con1:actions><con1:assign varName="localMessageParameters"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-7ffe</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters/></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="errorHandlerRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-7ffd</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/><con2:param name="additionalInformation"><con2:path>$null</con2:path></con2:param><con2:param name="currentFault"><con2:path>$fault</con2:path></con2:param><con2:param name="exceptionStackTrace"><con2:path>''</con2:path></con2:param><con2:param name="accessResourceName"><con2:path>'/Infraestrutura/transicao/relacionar/atendimento/proxyservice/IdentificarContratos12V2.proxy'</con2:path></con2:param><con2:param name="responseSOAPVersion"><con2:path>'1.2'</con2:path></con2:param><con2:param name="currentBody"><con2:path>$body</con2:path></con2:param><con2:param name="exceptionClassification"><con2:path>'CLASSIFICATION_UNEXPECTED'</con2:path></con2:param><con2:param name="messageParameters"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="processo"><con2:path>'rede'</con2:path></con2:param><con2:param name="macroProcesso"><con2:path>'INFRAESTRUTURA'</con2:path></con2:param><con2:param name="validationMessages"><con2:path>&lt;validationMessages/></con2:path></con2:param><con2:param name="callResponse"><con2:path>$localMessageParameters</con2:path></con2:param><con2:param name="messageCode"><con2:path>data($fault/ctx:errorCode)</con2:path></con2:param><con2:param name="currentInbound"><con2:path>$inbound</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-7ffc</con2:id><con1:service xsi:type="ref:ProxyRef" ref="general/NETESBExceptionHandler/proxyservice/NETESBExceptionHandler12V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>convertLocalExceptionToFault</con1:operation><con1:request><con1:body>$errorHandlerRequest</con1:body></con1:request><con1:response><con1:body>errorHandlerResponse</con1:body></con1:response><con1:requestTransform/><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-7ffb</con3:id><con2:logLevel>error</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$errorHandlerResponse</con3:xqueryText></con2:expr><con2:message>errorHandlerResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1580817698374214207--37eacd07.15862f3afeb.-7fec</con2:id><con1:logLevel>debug</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText></con1:expr><con1:message>body de saida IdentificarContratos12V2</con1:message></con1:log><con1:delete varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8503895208064038065--74e03b3f.145cd1d5763.-8000</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location></con1:delete>
          
        <con1:ifThenElse xmlns:http="http://www.bea.com/wli/sb/transports/http" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tran="http://www.bea.com/wli/sb/transports" xmlns:env="http://www.bea.com/wli/config/env" xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-118215193248057280-6920a02c.1731106cb6a.-8000</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains($body/soap-env:Fault/faultstring,
     "ORA-")</con2:xqueryText></con1:condition><con1:actions><con3:transport-headers xmlns:con1="http://www.bea.com/wli/sb/stages/config" xmlns:con2="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con3="http://www.bea.com/wli/sb/stages/transform/config"><con1:id>_ActionId-8357929311831198413--30d35dae.1720e402d09.-7ffe</con1:id><con3:header-set>inbound-response</con3:header-set><con3:header name="SOA-Code" value="expression"><con1:xqueryTransform><con1:resource ref="general/transformation/FormatTransportHeaderResponseORAErrorXQTv1"/><con1:param name="fault"><con1:path>$fault</con1:path></con1:param><con1:param name="body"><con1:path>$body</con1:path></con1:param></con1:xqueryTransform></con3:header></con3:transport-headers></con1:actions></con1:case><con1:default><con1:transport-headers>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-8860558302490276716--75ff3585.1699161cd2f.-8000</con2:id>
            <con1:header-set>inbound-response</con1:header-set>
            <con1:header name="SOA-Code" value="expression">
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/FormatTransportHeaderResponseCodeXQTv1"/>
                <con2:param name="body"><con2:path>$body</con2:path></con2:param>
                <con2:param name="fault"><con2:path>$fault</con2:path></con2:param>
              </con2:xqueryTransform>
	        </con1:header>
          </con1:transport-headers></con1:default></con1:ifThenElse></con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Consultar Contrato Por Codigo Cliente_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento NET HEADER" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7ff5">
        <con:comment>Estágio de Tratamento para o NET HEADER</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NetHeader" prefix="net" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff7</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/TransformarNetHeaderDefaults"/>
                <con2:param name="tokenDefault">
                  <con2:path>fn-bea:uuid()</con2:path>
                </con2:param>
                <con2:param name="netHeaderIN">
                  <con2:path>$header/net:NetHeader</con2:path>
                </con2:param>
                <con2:param name="numeroProtocoloDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="aplicacaoDefault">
                  <con2:path>'OTHER'</con2:path>
                </con2:param>
                <con2:param name="funcionalidadeDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="versaoServicoDefault">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="usernameDefault">
                  <con2:path>'OPS$URALM'</con2:path>
                </con2:param>
                <con2:param name="numeroChamadaDefault">
                  <con2:path>''</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff6</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
            <con1:message>IdentificarContratos11V2 - identificar contrato por codigo cliente. Header de Entrada.</con1:message>
          </con1:log>
        </con:actions>
      </con:stage>
      <con:stage name="Validação de dados de entrada">
        <con:comment>Valida se o atributo codigo cliente está preenchido</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">verificar dados de entrada</con2:comment><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-8000</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($body/iden:consultarContratoPorCodigoClienteRequest/codigoCliente)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fff</con3:id>
                  <con2:logLevel>error</con2:logLevel>
                  <con2:expr>
                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$body/iden:consultarContratoPorCodigoClienteRequest</con3:xqueryText>
                  </con2:expr>
                  <con2:message>Atributo Codigo Cliente não preenchido</con2:message>
                </con2:log>
                <con1:assign varName="validationMessages">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ffc</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="localMessageParameters">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ffb</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Cógigo Cliente'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:Error>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ffe</con2:id>
                  <con1:errCode>ATR-0032</con1:errCode>
                  <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
                </con1:Error>
              </con1:actions>
            </con1:case>
            <con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:matches(data($body/iden:consultarContratoPorCodigoClienteRequest/codigoCliente),
     "[^0-9]")</con2:xqueryText></con1:condition><con1:actions><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff5</con3:id><con2:logLevel>error</con2:logLevel><con2:message>CODIGO CLIENTE NÃO UM NUMERO INTEIRO</con2:message></con2:log><con1:assign varName="validationMessages"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff4</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText></con1:expr></con1:assign><con1:assign varName="localMessageParameters"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff3</con2:id><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Cógigo Cliente'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText></con1:expr></con1:assign><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff2</con2:id><con1:errCode>ATR-0085</con1:errCode><con1:message>O formato de um parâmetro está incorreto. O parâmetro correto é: código do assinante (numérico).</con1:message></con1:Error></con1:actions></con1:case><con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Identificar base de dados" errorHandler="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe9">
        <con:comment>Identificar base de dados com base nos 3 primeiros digitos do atributo codigo cliente</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/identificacaoOperadoraNET" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe7</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/iden:consultarContratoPorCodigoClienteRequest</con2:xqueryText>
            </con1:expr>
            <con1:message>consultar contrato por codigo cliente - identificação base de dados</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe5</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="general/NETSMSDatabaseConfig/proxyservice/IdentificacaoOperadoraNET11V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>identificarOperadoraNET</con1:operation>
            <con1:request>
              <con1:body>$identificarOperadoraNETRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>identificarOperadoraNETResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="identificarOperadoraNETRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe4</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;ns0:IdentificacaoOperadoraNET>
  &lt;ns0:CodigoOperadora>{fn:substring(data($body/iden:consultarContratoPorCodigoClienteRequest/codigoCliente),0,4)}&lt;/ns0:CodigoOperadora>
&lt;/ns0:IdentificacaoOperadoraNET></con2:xqueryText>
                </con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe3</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarOperadoraNETRequest</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe2</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarOperadoraNETResponse</con2:message>
              </con2:log>
            <con1:transport-headers copy-all="false"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4706474230797867455--6aecf4d8.17e73ebdba6.-7fec</con2:id><con1:header-set>inbound-response</con1:header-set><con1:header name="SOA-Base" value="expression"><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText></con1:header></con1:transport-headers></con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Consultar Contrato - Codigo Cliente " errorHandler="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fda">
        <con:comment>Consultar Contrato - Codigo Cliente</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/empresa" prefix="ns1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe1</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:message>consultar contrato no DSP</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fdf</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Infraestrutura/transicao/relacionar/atendimento/businessservice/ConsultarContratoAssinanteBS" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>identificarContratoPorCodigoCliente</con1:operation>
            <con1:request>
              <con1:body>$identificarContratoPorCodigoClienteRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>identificarContratoPorCodigoClienteResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="identificarContratoPorCodigoClienteRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fde</con2:id>
                <con1:expr>
                  <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                    <con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/consultarContratoPorCodigoClienteDSLXQuery"/>
                    <con2:param name="consultarContratoPorCodigoClienteRequest1">
                      <con2:path>$body/iden:consultarContratoPorCodigoClienteRequest</con2:path>
                    </con2:param>
                    <con2:param name="cidadeContrato">
                      <con2:path>data($identificarOperadoraNETResponse/ns1:IdentificacaoCidade)</con2:path>
                    </con2:param>
                  </con2:xqueryTransform>
                </con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fdd</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratoPorCodigoClienteRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarContratoPorCodigoClienteRequest</con2:message>
              </con2:log>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6686049497333459227--42050753.143ddf94ef4.-8000</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">data($identificarOperadoraNETResponse/aliasDatabase)</con3:xqueryText>
                </con2:expr>
                <con2:message>base de dados localizada</con2:message>
              </con2:log>
              <con1:transport-headers>
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fdb</con2:id>
                <con1:header-set>outbound-request</con1:header-set>
                <con1:header value="expression" name="j_identity_base">
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText>
                </con1:header>
              </con1:transport-headers>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fdc</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratoPorCodigoClienteResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarContratoPorCodigoClienteResponse</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Consultar Contrato Por Codigo Cliente_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de resposta">
        <con:context>
          
          <con1:userNsDecl namespace="http://www.netservicos.com.br/ContratoAssinante" prefix="ns5" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/><con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd8</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            
            <con1:message>Tratamento de Resposta da consulta de contrato por codigo cliente</con1:message>
          </con1:log><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">verifica se a consulta de contratos por codigo cliente retornou dados</con2:comment><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7fff</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">not(empty($identificarContratoPorCodigoClienteResponse/ns5:contratoAssinante))</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7ffc</con3:id>
                  <con2:logLevel>debug</con2:logLevel>
                  <con2:message>dados encontratos</con2:message>
                </con2:log>
                <con1:assign varName="retorno">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fd7</con2:id>
                  <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/RetornoDSLIdentificarContratosCodClienteXQuery"/><con2:param name="identificarContratoPorCodigoClienteResponse1"><con2:path>$identificarContratoPorCodigoClienteResponse</con2:path></con2:param></con2:xqueryTransform></con1:expr>
                </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7ffc</con3:id>
                  <con2:logLevel>info</con2:logLevel>
                  <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$retorno</con3:xqueryText></con2:expr><con2:message>### RETORNO</con2:message>
                </con2:log><con1:foreach><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-8000</con2:id><con1:variable>identificarContratoPorCodigoClienteResponse</con1:variable><con1:expression><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./ns5:contratoAssinante</con2:xpathText></con1:expression><con1:value-variable>contrato</con1:value-variable><con1:index-variable>idx</con1:index-variable><con1:total-variable>contador</con1:total-variable><con1:actions><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-980524747130604282-29d537af.15f25f09859.-8000</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($contrato/ns5:MIGRACAO_NET_UNO) = '1'</con2:xqueryText></con1:condition><con1:actions><con1:replace varName="retorno" contents-only="false"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7594215933677335466--558a46c5.15fb5aa3496.-8000</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./ns5:contratoAssinante</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">''</con2:xqueryText></con1:expr></con1:replace></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:foreach><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7ffc</con3:id>
                  <con2:logLevel>info</con2:logLevel>
                  <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$retorno</con3:xqueryText></con2:expr><con2:message>### RETORNO COM CONTRATO DELETADO</con2:message>
                </con2:log><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($retorno/ns5:contratoAssinante)</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-7ffb</con2:id><con1:errCode>ATR-0086</con1:errCode><con1:message>Assinante migrado para a base UNO.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-8000</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorCodigoClienteResponse>
		{$retorno}
&lt;/iden:consultarContratoPorCodigoClienteResponse>

</con2:xqueryText></con1:expr>
          </con1:replace></con1:actions>
            </con1:case>
            <con1:default>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7ffb</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:message>sem retorno##</con2:message>
              </con2:log>
              
            <con1:replace varName="body" contents-only="true"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2010722068053318164--58a18dc9.1454d10593e.-7ffc</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorCodigoClienteResponse/></con2:xqueryText></con1:expr></con1:replace></con1:default>
          </con1:ifThenElse>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6686049497333459227--42050753.143ddf94ef4.-7fff</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$retorno</con2:xqueryText>
            </con1:expr>
            <con1:message>####retorno###</con1:message>
          </con1:log>
          
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fff</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Identificar Contratos: oretorno da consulta por codigo cliente</con1:message>
          </con1:log>
        <con1:delete varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2782663356395872312--37dc4afe.1451e499e07.-8000</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location></con1:delete></con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe9" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio identificação base de dados</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fe8</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL IDENTIFICAR A BASE DO CONTRATO INFORMADO.</con1:message>
          </con1:log>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2248766588846812300--7daa30f7.143d37bce0d.-7fe9</con2:id>
            <con1:errCode>ATR-0028</con1:errCode>
            <con1:message>Não foi possível identificar a base do contrato informado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fda" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio de consulta contrato por codigo cliente no DSP</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2877978171829717322-2e6d1b85.143a6b6cd1d.-7fd9</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL CONSULTAR CONTRATOS POR CONTRATO (consulta DSP).</con1:message>
          </con1:log>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2248766588846812300--7daa30f7.143d37bce0d.-7fe5</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Erro inesperado</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Consultar Contrato por Protocolo_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento NET HEADER" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fdf">
        <con:comment>Estágio de Tratamento para o NET HEADER</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NetHeader" prefix="net" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe1</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/TransformarNetHeaderDefaults"/>
                <con2:param name="tokenDefault">
                  <con2:path>fn-bea:uuid()</con2:path>
                </con2:param>
                <con2:param name="netHeaderIN">
                  <con2:path>$header/net:NetHeader</con2:path>
                </con2:param>
                <con2:param name="numeroProtocoloDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="aplicacaoDefault">
                  <con2:path>'OTHER'</con2:path>
                </con2:param>
                <con2:param name="funcionalidadeDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="versaoServicoDefault">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="usernameDefault">
                  <con2:path>'OPS$URALM'</con2:path>
                </con2:param>
                <con2:param name="numeroChamadaDefault">
                  <con2:path>''</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe0</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
            <con1:message>IdentificarContratos11V2 - identificar contrato por protocolo Header de Entrada.</con1:message>
          </con1:log>
        </con:actions>
      </con:stage>
      <con:stage name="Validar Dados de Entrada" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fd6">
        <con:comment>Validar Dados de Entrada - atributo protocolo deve estar preenchido</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">verifica se o atributo numero protocolo está preenchido</con2:comment>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fdb</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($body/iden:consultarContratosPorProtocoloRequest/protocolo)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fda</con3:id>
                  <con2:logLevel>error</con2:logLevel>
                  <con2:message>ERRO: Identificar Contratos - atributo protocolo não preenchido</con2:message>
                </con2:log>
                <con1:assign varName="validationMessages">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd9</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="localMessageParameters">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd8</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Protocolo'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:Error>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd7</con2:id>
                  <con1:errCode>ATR-0032</con1:errCode>
                  <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
                </con1:Error>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Identificar Base de Dados" errorHandler="_onErrorHandler-2350086241785725866--586e9d4.143ceda4ed5.-7ff9">
        <con:comment>Identificar Base de Dados - os 3 primeiros digitos do protoco é o codigo operadora</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/identificacaoOperadoraNET" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ffe</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/iden:consultarContratosPorProtocoloRequest</con2:xqueryText>
            </con1:expr>
            <con1:message>Consultar Contrato por Protocolo @@</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ffd</con2:id>
            <con1:service xsi:type="ref:ProxyRef" ref="general/NETSMSDatabaseConfig/proxyservice/IdentificacaoOperadoraNET11V1" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>identificarOperadoraNET</con1:operation>
            <con1:request>
              <con1:body>$identificarOperadoraNETRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>identificarOperadoraNETResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="identificarOperadoraNETRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ffc</con2:id>
                <con1:expr>
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;ns0:IdentificacaoOperadoraNET>
  &lt;ns0:CodigoOperadora>{fn:substring(data($body/iden:consultarContratosPorProtocoloRequest/protocolo),0,4)}&lt;/ns0:CodigoOperadora>
&lt;/ns0:IdentificacaoOperadoraNET></con2:xqueryText>
                </con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ffb</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarOperadoraNETRequest</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ffa</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarOperadoraNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarOperadoraNETResponse</con2:message>
              </con2:log>
            <con1:transport-headers copy-all="false"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4706474230797867455--6aecf4d8.17e73ebdba6.-7fea</con2:id><con1:header-set>inbound-response</con1:header-set><con1:header name="SOA-Base" value="expression"><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText></con1:header></con1:transport-headers></con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Identificar Contrato - Consulta por Protocolo" errorHandler="_onErrorHandler-2350086241785725866--586e9d4.143ceda4ed5.-7ff1">
        <con:comment>Identificar Contrato - Consulta por Protocolo</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/empresa" prefix="ns1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff7</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:message>consultar contrato por protocolo</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff6</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Infraestrutura/transicao/relacionar/atendimento/businessservice/ConsultarContratoAssinanteBS" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            <con1:operation>identificarContratoPorProtocolo</con1:operation>
            <con1:request>
              <con1:body>$identificarContratoPorProtocoloRequest</con1:body>
            </con1:request>
            <con1:response>
              <con1:body>identificarContratoPorProtocoloResponse</con1:body>
            </con1:response>
            <con1:requestTransform>
              <con1:assign varName="identificarContratoPorProtocoloRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff5</con2:id>
                <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/ConsultarContratoPorProtocoloDSLXQuery"/><con2:param name="consultarContratosPorProtocoloRequest1"><con2:path>$body/iden:consultarContratosPorProtocoloRequest</con2:path></con2:param></con2:xqueryTransform></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff4</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratoPorProtocoloRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarContratoPorProtocoloRequest</con2:message>
              </con2:log>
              <con1:transport-headers>
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff3</con2:id>
                <con1:header-set>outbound-request</con1:header-set>
                <con1:header value="expression" name="j_identity_base">
                  <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">data($identificarOperadoraNETResponse/aliasDatabase)</con2:xqueryText>
                </con1:header>
              </con1:transport-headers>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff2</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratoPorProtocoloResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>identificarContratoPorProtocoloResponse</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Consultar Contrato por Protocolo_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de resposta">
        <con:comment>Tratamento de resposta da consulta de contrato por protocolo</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/ContratoAssinante" prefix="ns5" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd8</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            
            <con1:message>Tratamento de Resposta da consulta de contrato por protocolo</con1:message>
          </con1:log><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7227087142709378124-6d1f633.143f7932c1c.-7ffa</con2:id>
            <con1:case>
              <con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">not(empty($identificarContratoPorProtocoloResponse/ns5:contratoAssinante))</con2:xqueryText></con1:condition>
              <con1:actions>
                <con1:assign varName="retorno">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fee</con2:id>
                  <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/RetornoDSLIdentificarContratosProtocoloXQuery"/><con2:param name="identificarContratoPorProtocoloResponse1"><con2:path>$identificarContratoPorProtocoloResponse</con2:path></con2:param></con2:xqueryTransform></con1:expr>
                </con1:assign>
              <con1:foreach><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-8000</con2:id><con1:variable>identificarContratoPorProtocoloResponse</con1:variable><con1:expression><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./ns5:contratoAssinante</con2:xpathText></con1:expression><con1:value-variable>contrato</con1:value-variable><con1:index-variable>idx</con1:index-variable><con1:total-variable>contador</con1:total-variable><con1:actions><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-980524747130604282-29d537af.15f25f09859.-8000</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:data($contrato/ns5:MIGRACAO_NET_UNO) = '1'</con2:xqueryText></con1:condition><con1:actions><con1:replace varName="retorno" contents-only="false"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-7594215933677335466--558a46c5.15fb5aa3496.-8000</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./ns5:contratos/ns5:contratoAssinante</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">''</con2:xqueryText></con1:expr></con1:replace></con1:actions></con1:case><con1:default/></con1:ifThenElse></con1:actions></con1:foreach><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($retorno/ns5:contratos/ns5:contratoAssinante)</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5701477294958896631--acb7140.15f2b5872b1.-7ffb</con2:id><con1:errCode>ATR-0086</con1:errCode><con1:message>Assinante migrado para a base UNO.</con1:message></con1:Error></con1:actions></con1:case><con1:default/></con1:ifThenElse><con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fec</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$retorno

</con2:xqueryText></con1:expr>
          </con1:replace></con1:actions>
            </con1:case>
            <con1:default>
              
            <con1:replace varName="body" contents-only="true"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2010722068053318164--58a18dc9.1454d10593e.-7fff</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratosPorProtocoloResponse/></con2:xqueryText></con1:expr></con1:replace></con1:default>
          </con1:ifThenElse>
          
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7feb</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Identificar Contrato Response - consulta por protocolo</con1:message>
          </con1:log>
        <con1:delete varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2782663356395872312--37dc4afe.1451e499e07.-7ffe</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location></con1:delete></con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-2350086241785725866--586e9d4.143ceda4ed5.-7ff9" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio de identificação de base de base de dados</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff8</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL IDENTIFICAR BASE DE DADOS DO PROTOCOLO INFORMADO.</con1:message>
          </con1:log>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2248766588846812300--7daa30f7.143d37bce0d.-7fe7</con2:id>
            <con1:errCode>ATR-0028</con1:errCode>
            <con1:message>Não foi possível identificar a base do contrato informado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-2350086241785725866--586e9d4.143ceda4ed5.-7ff1" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio de consulta contrato por protocolo</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7ff0</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL CONSULTAR CONTRATOS POR PROTOCOLO (consulta DSP).</con1:message>
          </con1:log>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2248766588846812300--7daa30f7.143d37bce0d.-7fe4</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Erro inesperado</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Consultar Contratos por Documento_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento NET HEADER" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fee">
        <con:comment>Estágio de Tratamento para o NET HEADER</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NetHeader" prefix="net" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff0</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/TransformarNetHeaderDefaults"/>
                <con2:param name="tokenDefault">
                  <con2:path>fn-bea:uuid()</con2:path>
                </con2:param>
                <con2:param name="netHeaderIN">
                  <con2:path>$header/net:NetHeader</con2:path>
                </con2:param>
                <con2:param name="numeroProtocoloDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="aplicacaoDefault">
                  <con2:path>'OTHER'</con2:path>
                </con2:param>
                <con2:param name="funcionalidadeDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="versaoServicoDefault">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="usernameDefault">
                  <con2:path>'OPS$URALM'</con2:path>
                </con2:param>
                <con2:param name="numeroChamadaDefault">
                  <con2:path>''</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fef</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
            <con1:message>IdentificarContratos11V2 - identificar contrato por documento Header de Entrada.</con1:message>
          </con1:log>
        </con:actions>
      </con:stage>
      <con:stage name="Validar Dados de Entrada" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fe5">
        <con:comment>Validar Dados de Entrada - atributo documento deve estar preenchido</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">validação do atributo documento</con2:comment>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fea</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($body/iden:consultarContratoPorDocumentoRequest/documento)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe9</con3:id>
                  <con2:logLevel>error</con2:logLevel>
                  <con2:message>ERRO: Identificar Contratos - atributo documento não preenchido</con2:message>
                </con2:log>
                <con1:assign varName="validationMessages">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe8</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="localMessageParameters">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe7</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Documento'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:Error>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe6</con2:id>
                  <con1:errCode>ATR-0032</con1:errCode>
                  <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
                </con1:Error>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Listar Bases Ativas" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fb4">
        <con:comment>Listar Bases de dados Ativas</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/IdentificacaoOperadoraNET/" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fbb</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Listando bases de dados ativas</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fba</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="general/NETSMSDatabaseConfig/BusinessService/NETSMSDatabaseBusinessService" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            
            <con1:operation>getActiveDatasources</con1:operation><con1:request><con1:body>$getActiveDatasourcesRequest</con1:body></con1:request>
            <con1:response><con1:body>getActiveDatasourcesResponse</con1:body></con1:response>
            <con1:requestTransform>
              <con1:assign varName="getActiveDatasourcesRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fbf</con2:id>
                <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;open:getActiveDatasources xmlns:open="http://www.openuri.org/">  

&lt;/open:getActiveDatasources></con2:xqueryText></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fbe</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$listarOperadorasNETRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>Lista operadoras request</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fbd</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$getActiveDatasourcesResponse</con3:xqueryText></con2:expr><con2:message>Lista bases ativas response</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
      <con:stage name="Solicitar consulta Split Join" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7f77">
        <con:comment>delega a a identificação contratos por documento para o Split Join</con:comment>
        <con:context>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/ListarContratos/" prefix="lis" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7f87</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Iniciando stage de execução do spli join</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fa1</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="Infraestrutura/transicao/relacionar/atendimento/businessservice/IdentificarContratosSplitJoin" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            
            <con1:operation>identificarContratos</con1:operation><con1:request><con1:body>$solicitarBuscaContratosMultiBaseRequest</con1:body></con1:request>
            <con1:response><con1:body>solicitarBuscaContratosMultiBaseResponse</con1:body></con1:response>
            <con1:requestTransform>
              <con1:assign varName="solicitarBuscaContratosMultiBaseRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fb8</con2:id>
                <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/ConsultarContratosPorDocumentoSplitJoinRequestXQuery"/><con2:param name="listaBasesAtivas"><con2:path>$getActiveDatasourcesResponse</con2:path></con2:param><con2:param name="consultarContratoPorDocumentoRequest1"><con2:path>$body/iden:consultarContratoPorDocumentoRequest</con2:path></con2:param></con2:xqueryTransform></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fb7</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$solicitarBuscaContratosMultiBaseRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>Request ao Split Join - Consultar Contratos Por Contratos</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fb6</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$solicitarBuscaContratosMultiBaseResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>$solicitarBuscaContratosMultiBaseResponse - retorno do split join</con2:message>
              </con2:log>
              
              
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="response" name="Consultar Contratos por Documento_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Resposta">
        <con:comment>Tratamento de Resposta da consulta de contrato por documento</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/ContratoAssinante" prefix="ns5" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          
          
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd8</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            
            <con1:message>Tratamento de Resposta da consulta de contrato por documento</con1:message>
          </con1:log><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">verifica se a consulta de contratos por documentos retornou dados</con2:comment><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1895901039399405600--4f6088e4.14560b4db0d.-7fff</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">not(empty($solicitarBuscaContratosMultiBaseResponse/ns5:contratoAssinante))</con2:xqueryText></con1:condition><con1:actions><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5600875543299578002-28ad5050.15fc5fa55d6.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains($solicitarBuscaContratosMultiBaseResponse,
     'ATR-0086')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff0</con2:id><con1:errCode>ATR-0086</con1:errCode><con1:message>Assinante migrado para a base UNO.</con1:message></con1:Error></con1:actions></con1:case><con1:default><con1:replace varName="body" contents-only="true"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1895901039399405600--4f6088e4.14560b4db0d.-7ffc</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorDocumentoResponse>
	&lt;ns5:contratos>
		{$solicitarBuscaContratosMultiBaseResponse/ns5:contratoAssinante}
	&lt;/ns5:contratos>
&lt;/iden:consultarContratoPorDocumentoResponse></con2:xqueryText></con1:expr></con1:replace></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd5</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorDocumentoResponse/>		</con2:xqueryText></con1:expr>
          </con1:replace></con1:default></con1:ifThenElse>
          <con1:delete varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1895901039399405600--4f6088e4.14560b4db0d.-7ffb</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location></con1:delete><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd4</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Response Consultar Contrato por documento</con1:message>
          </con1:log>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="request" name="Consultar Contrato por Telefone_request" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento NET HEADER" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fd0">
        <con:comment>Estágio de Tratamento para o NET HEADER</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NetHeader" prefix="net" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:replace varName="header" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd2</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr>
              <con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/transformation/TransformarNetHeaderDefaults"/>
                <con2:param name="tokenDefault">
                  <con2:path>fn-bea:uuid()</con2:path>
                </con2:param>
                <con2:param name="numeroProtocoloDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="netHeaderIN">
                  <con2:path>$header/net:NetHeader</con2:path>
                </con2:param>
                <con2:param name="aplicacaoDefault">
                  <con2:path>'OTHER'</con2:path>
                </con2:param>
                <con2:param name="funcionalidadeDefault">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="versaoServicoDefault">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="usernameDefault">
                  <con2:path>'OPS$URALM'</con2:path>
                </con2:param>
                <con2:param name="numeroChamadaDefault">
                  <con2:path>''</con2:path>
                </con2:param>
              </con2:xqueryTransform>
            </con1:expr>
          </con1:replace>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd1</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$header</con2:xqueryText>
            </con1:expr>
            <con1:message>IdentificarContratos11V2 - identificar contrato por telefone Header de Entrada.</con1:message>
          </con1:log>
        </con:actions>
      </con:stage>
      <con:stage name="Validar Dados de Entrada" errorHandler="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fc6">
        <con:comment>Validar Dados de Entrada - atributo telefone deve estar preenchido</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/NETESBExceptionHandler12V1" prefix="excephdlr" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/modelocanonico/v2/logging" prefix="logging" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">valida se atributo telefone está preenchido</con2:comment>
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fcc</con2:id>
            <con1:case>
              <con1:condition>
                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">empty($body/iden:consultarContratoPorTelefoneRequest/telefone)</con2:xqueryText>
              </con1:condition>
              <con1:actions>
                <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                  <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fca</con3:id>
                  <con2:logLevel>error</con2:logLevel>
                  <con2:message>ERRO: Identificar Contratos - atributo telefone não preenchido</con2:message>
                </con2:log>
                <con1:assign varName="validationMessages">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fcb</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:validationMessages/></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:assign varName="localMessageParameters">
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fc8</con2:id>
                  <con1:expr>
                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;excephdlr:messageParameters>     
      &lt;logging:value>{'Protocolo'}&lt;/logging:value>
&lt;/excephdlr:messageParameters></con2:xqueryText>
                  </con1:expr>
                </con1:assign>
                <con1:Error>
                  <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fc7</con2:id>
                  <con1:errCode>ATR-0032</con1:errCode>
                  <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
                </con1:Error>
              </con1:actions>
            </con1:case>
            <con1:default/>
          </con1:ifThenElse>
        </con:actions>
      </con:stage>
      <con:stage name="Listar Bases Ativas" errorHandler="_onErrorHandler-6593127875952775738-536e662c.14504e43049.-7ffb">
        <con:comment>Listar Bases de dados Ativas</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/IdentificacaoOperadoraNET/" prefix="ns0" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-8000</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
            </con1:expr>
            <con1:message>Listando bases de dados ativas</con1:message>
          </con1:log>
          <con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7fff</con2:id>
            <con1:service xsi:type="ref:BusinessServiceRef" ref="general/NETSMSDatabaseConfig/BusinessService/NETSMSDatabaseBusinessService" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
            
            <con1:operation>getActiveDatasources</con1:operation><con1:request><con1:body>$listarOperadorasNETRequest</con1:body></con1:request>
            <con1:response><con1:body>listarOperadorasNETResponse</con1:body></con1:response>
            <con1:requestTransform>
              <con1:assign varName="listarOperadorasNETRequest">
                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ffe</con2:id>
                <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;open:getActiveDatasources xmlns:open="http://www.openuri.org/">  

&lt;/open:getActiveDatasources></con2:xqueryText></con1:expr>
              </con1:assign>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ffd</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$listarOperadorasNETRequest</con3:xqueryText>
                </con2:expr>
                <con2:message>listarOperadorasNETRequest</con2:message>
              </con2:log>
            </con1:requestTransform>
            <con1:responseTransform>
              <con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config">
                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ffc</con3:id>
                <con2:logLevel>debug</con2:logLevel>
                <con2:expr>
                  <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$listarOperadorasNETResponse</con3:xqueryText>
                </con2:expr>
                <con2:message>listarOperadorasNETResponse</con2:message>
              </con2:log>
            </con1:responseTransform>
          </con1:wsCallout>
        </con:actions>
      </con:stage>
    <con:stage name="Solicitar consulta Split Join" errorHandler="_onErrorHandler-6593127875952775738-536e662c.14504e43049.-7fef"><con:comment>delega a a identificação contratos por telefone  para o Split Join</con:comment><con:context><con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff4</con2:id><con1:logLevel>debug</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText></con1:expr><con1:message>Iniciando stage de execução do spli join</con1:message></con1:log><con1:wsCallout xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff3</con2:id><con1:service xsi:type="ref:BusinessServiceRef" ref="Infraestrutura/transicao/relacionar/atendimento/businessservice/IdentificarContratosSplitJoin" xmlns:ref="http://www.bea.com/wli/sb/reference" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/><con1:operation>identificarContratos</con1:operation><con1:request><con1:body>$identificarContratosRequest</con1:body></con1:request><con1:response><con1:body>identificarContratosResponse</con1:body></con1:response><con1:requestTransform><con1:assign varName="identificarContratosRequest"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff2</con2:id><con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config"><con2:resource ref="Infraestrutura/transicao/relacionar/atendimento/transformation/ConsultarContratosPorTelefoneSplitJoinRequestXQuery"/><con2:param name="listaBasesAtivas"><con2:path>$listarOperadorasNETResponse</con2:path></con2:param><con2:param name="consultarContratoPorTelefoneRequest1"><con2:path>$body/iden:consultarContratoPorTelefoneRequest</con2:path></con2:param></con2:xqueryTransform></con1:expr></con1:assign><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff1</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratosRequest</con3:xqueryText></con2:expr><con2:message>IdentificarContratos12V2  - identificarContratosRequest</con2:message></con2:log></con1:requestTransform><con1:responseTransform><con2:log xmlns:con2="http://www.bea.com/wli/sb/stages/logging/config"><con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff0</con3:id><con2:logLevel>debug</con2:logLevel><con2:expr><con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$identificarContratosResponse</con3:xqueryText></con2:expr><con2:message>IdentificarContratos12V2 - identificarContratosResponse</con2:message></con2:log></con1:responseTransform></con1:wsCallout></con:actions></con:stage></con:pipeline>
    <con:pipeline type="response" name="Consultar Contrato por Telefone_response" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento Resposta">
        <con:comment>Tratamento Resposta da operação consultar contrato por telefone</con:comment>
        <con:context>
          <con1:userNsDecl namespace="http://www.netservicos.com.br/ContratoAssinante" prefix="ns5" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
          <con1:varNsDecl namespace="http://www.netservicos.com.br/IdentificarContratos/" prefix="iden" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
        </con:context>
        <con:actions>
          
          
          
        <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd8</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            
            <con1:message>Tratamento de Resposta da consulta de contrato por telefone</con1:message>
          </con1:log><con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">verifica se a consulta de contratos por documentos retornou dados</con2:comment><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-1895901039399405600--4f6088e4.14560b4db0d.-7fff</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">not(empty($identificarContratosResponse/ns5:contratoAssinante))</con2:xqueryText></con1:condition><con1:actions><con1:ifThenElse><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-5600875543299578002-28ad5050.15fc5fa55d6.-7ffe</con2:id><con1:case><con1:condition><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:contains($identificarContratosResponse,
     'ATR-0086')</con2:xqueryText></con1:condition><con1:actions><con1:Error><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6101344389522702860--23cdd7ca.15867983efe.-7ff0</con2:id><con1:errCode>ATR-0086</con1:errCode><con1:message>Assinante migrado para a base UNO.</con1:message></con1:Error></con1:actions></con1:case><con1:default><con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fc1</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorTelefoneResponse>
	&lt;ns5:contratos>
		{$identificarContratosResponse/ns5:contratoAssinante}
	&lt;/ns5:contratos>
&lt;/iden:consultarContratoPorTelefoneResponse></con2:xqueryText></con1:expr>
          </con1:replace></con1:default></con1:ifThenElse></con1:actions></con1:case><con1:default><con1:replace varName="body" contents-only="true">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fd5</con2:id>
            <con1:location>
              <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
            </con1:location>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">&lt;iden:consultarContratoPorTelefoneResponse/>		</con2:xqueryText></con1:expr>
          </con1:replace></con1:default></con1:ifThenElse><con1:delete varName="header" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2172451879945436375--5ad1abb2.145665325a0.-8000</con2:id><con1:location><con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText></con1:location></con1:delete><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-2350086241785725866--586e9d4.143ceda4ed5.-7fc3</con2:id>
            <con1:logLevel>debug</con1:logLevel>
            <con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText></con1:expr>
            <con1:message>IdentificarContratos12V2 - retorno consulta por telefone</con1:message>
          </con1:log></con:actions>
      </con:stage>
    </con:pipeline>
    
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7ff5" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento Erro Local">
        <con:comment>Tratamento Erro Local para tratamneto do NET Header</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff4</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO NO ESTAGIO NET HEADER - CONSULTA POR CONTRATO</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff3</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - tratamneto NET Header'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0003'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7ff2</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Ocorreu um erro inesperado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fee" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento Erro Local">
        <con:comment>Tratamento Erro Local para tratamneto do NET Header</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fed</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO NO ESTAGIO NET HEADER - CONSULTA POR DOCUMENTO</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fec</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'Identificar Contratos - consulta por doc - Trata Header'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0003'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7feb</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Ocorreu um erro inesperado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fe5" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro Local">
        <con:comment>Identificar Contratos - consulta por doc - validação de dados de entrada</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe4</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO DE VALIDAÇÃO NA CONSULTA POR DOCUMENTO</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe3</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por documento - validação de dados de entrada'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0007'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fe2</con2:id>
            <con1:errCode>ATR-0032</con1:errCode>
            <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fdf" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento Erro Local">
        <con:comment>Tratamento Erro Local para tratamneto do NET Header</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fde</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO NO ESTAGIO NET HEADER - CONSULTA POR PROTOCOLO</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fdd</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por protocolo - trata Header'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0003'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fdc</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Ocorreu um erro inesperado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fd6" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro Local">
        <con:comment>Identificar Contratos - consulta por protocolo- validação de dados de entrada</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd5</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO DE VALIDAÇÃO NA CONSULTA POR PROTOCOLO</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd4</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por protocolo - validação de dados de entrada'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0008'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fd3</con2:id>
            <con1:errCode>ATR-0032</con1:errCode>
            <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fd0" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento Erro Local">
        <con:comment>Tratamento Erro Local para tratamneto do NET Header</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fcf</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO NO ESTAGIO NET HEADER - CONSULTA POR TELEFONE</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fce</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por telefone - trata Header'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0003'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fcd</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Ocorreu um erro inesperado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fc6" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro Local">
        <con:comment>Identificar Contratos - consulta por protocolo- validação de dados de entrada</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fc5</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: ERRO DE VALIDAÇÃO NA CONSULTA POR TELEFONE</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fc4</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por telefone - validação de dados de entrada'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_VALIDATION'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$validationMessages</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$localMessageParameters</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0009'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fc3</con2:id>
            <con1:errCode>ATR-0032</con1:errCode>
            <con1:message>Dados obrigatórios para identificação do contrato não preenchidos corretamente. Informar um e apenas um dos parâmetros: COD_ASSINANTE, TELEFONE, CPF_CNPJ OU PROTOCOLO.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7fb4" type="error" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio Lista bases de dados ativas</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fb6</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL LISTAR BASES DE DADOS DO DOCUMENTO INFORMADO.</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fb3</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por documento - lista base ativas'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_RESOURCE'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0001'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7fb5</con2:id>
            <con1:errCode>ATR-0028</con1:errCode>
            <con1:message>Não foi possível identificar a base do contrato informado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline name="_onErrorHandler-4186301960304431635-72845ac3.144fe7badc4.-7f77" type="error" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro no estagio que solicita a execução no Split Join</con:comment>
        <con:context><con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7f79</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL LISTAR CONTRATOS DO DOCUMENTO INFORMADO (SPLIT JOIN).</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7f6f</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por documento - execução split join'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_RESOURCE'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0001'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7f78</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Erro inesperado</con1:message>
          </con1:Error></con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-6593127875952775738-536e662c.14504e43049.-7ffb" xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:stage name="Tratamento de Erro">
        <con:comment>Tratamento de Erro do estagio Lista bases de dados ativas</con:comment>
        <con:context/>
        <con:actions>
          <con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ffa</con2:id>
            <con1:logLevel>error</con1:logLevel>
            <con1:expr>
              <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText>
            </con1:expr>
            <con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL LISTAR BASES DE DADOS DO TELEFONE INFORMADO.</con1:message>
          </con1:log>
          <con1:assign varName="errorHandlerRequest" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff9</con2:id>
            <con1:expr><con2:xqueryTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                <con2:resource ref="general/NETESBExceptionHandler/transformation/TransformarEntradaExceptionHandlerXQuery"/>
                <con2:param name="additionalInformation">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="currentFault">
                  <con2:path>$fault</con2:path>
                </con2:param>
                <con2:param name="exceptionStackTrace">
                  <con2:path>''</con2:path>
                </con2:param>
                <con2:param name="accessResourceName">
                  <con2:path>'IdentificarContratos12V2 - consulta por telefone - listar bases ativas'</con2:path>
                </con2:param>
                <con2:param name="responseSOAPVersion">
                  <con2:path>'1.2'</con2:path>
                </con2:param>
                <con2:param name="currentBody">
                  <con2:path>$body</con2:path>
                </con2:param>
                <con2:param name="exceptionClassification">
                  <con2:path>'CLASSIFICATION_RESOURCE'</con2:path>
                </con2:param>
                <con2:param name="messageParameters">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="processo">
                  <con2:path>'rede'</con2:path>
                </con2:param>
                <con2:param name="macroProcesso">
                  <con2:path>'INFRAESTRUTURA'</con2:path>
                </con2:param>
                <con2:param name="callResponse">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="validationMessages">
                  <con2:path>$null</con2:path>
                </con2:param>
                <con2:param name="messageCode">
                  <con2:path>'ESB-TRANSICAO-0001'</con2:path>
                </con2:param>
                <con2:param name="currentInbound">
                  <con2:path>$inbound</con2:path>
                </con2:param>
              </con2:xqueryTransform></con1:expr>
          </con1:assign>
          <con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7ff8</con2:id>
            <con1:errCode>ATR-0028</con1:errCode>
            <con1:message>Não foi possível identificar a base do contrato informado.</con1:message>
          </con1:Error>
        </con:actions>
      </con:stage>
    </con:pipeline>
    <con:pipeline type="error" name="_onErrorHandler-6593127875952775738-536e662c.14504e43049.-7fef" xmlns:con="http://www.bea.com/wli/sb/pipeline/config"><con:stage name="Tratamento de Erro"><con:comment>Tratamento de Erro ocorrido durante a execução do processo paralelo (Split Joint) identificação contratos por telefone</con:comment><con:context><con1:userNsDecl namespace="http://www.bea.com/wli/sb/stages/transform/config" prefix="con1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/></con:context><con:actions><con1:log xmlns:con1="http://www.bea.com/wli/sb/stages/logging/config"><con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-6593127875952775738-536e662c.14504e43049.-7fee</con2:id><con1:logLevel>error</con1:logLevel><con1:expr><con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault</con2:xqueryText></con1:expr><con1:message>IDENTIFICAR CONTRATOS 12V2: NÃO FOI POSSÍVEL LISTAR CONTRATOS DO TELEFONE INFORMADO (SPLIT JOIN).</con1:message></con1:log><con1:Error xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-4186301960304431635-72845ac3.144fe7badc4.-7f78</con2:id>
            <con1:errCode>ATR-9999</con1:errCode>
            <con1:message>Erro inesperado</con1:message>
          </con1:Error></con:actions></con:stage></con:pipeline><con:flow xmlns:con="http://www.bea.com/wli/sb/pipeline/config">
      <con:branch-node type="operation" name="Identificar Contratos">
        <con:comment>Operações do serviço Identificar Contratos</con:comment>
        <con:context/>
        <con:branch-table>
          <con:branch name="consultarContratoPorCodigoCliente">
            <con:operator>equals</con:operator>
            <con:value/>
            <con:flow>
              <con:pipeline-node name="Consultar Contrato Por Codigo Cliente">
                <con:comment>Consultar Contrato Por Codigo Cliente</con:comment>
                <con:request>Consultar Contrato Por Codigo Cliente_request</con:request>
                <con:response>Consultar Contrato Por Codigo Cliente_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="consultarContratoPorDocumento">
            <con:operator>equals</con:operator>
            <con:value/>
            <con:flow>
              <con:pipeline-node name="Consultar Contratos por Documento">
                <con:comment>Consultar Contratos por Documento - CPF ou CNPJ</con:comment>
                <con:request>Consultar Contratos por Documento_request</con:request>
                <con:response>Consultar Contratos por Documento_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="consultarContratosPorProtocolo">
            <con:operator>equals</con:operator>
            <con:value/>
            <con:flow>
              <con:pipeline-node name="Consultar Contrato por Protocolo">
                <con:comment>Consultar Contrato por Protocolo</con:comment>
                <con:request>Consultar Contrato por Protocolo_request</con:request>
                <con:response>Consultar Contrato por Protocolo_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:branch name="consultarContratoPorTelefone">
            <con:operator>equals</con:operator>
            <con:value/>
            <con:flow>
              <con:pipeline-node name="Consultar Contrato por Telefone">
                <con:comment>Consultar Contrato por Telefone</con:comment>
                <con:request>Consultar Contrato por Telefone_request</con:request>
                <con:response>Consultar Contrato por Telefone_response</con:response>
              </con:pipeline-node>
            </con:flow>
          </con:branch>
          <con:default-branch>
            <con:flow/>
          </con:default-branch>
        </con:branch-table>
      </con:branch-node>
    </con:flow>
  </ser:router>
</xml-fragment>